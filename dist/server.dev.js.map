{"version":3,"sources":["server.js"],"names":["express","require","mongoose","cors","app","PORT","PDFDocument","use","origin","methods","allowedHeaders","json","limit","urlencoded","extended","req","res","next","headers","body","JSON","parse","console","log","e","error","dbURI","connect","then","err","userSchema","Schema","username","type","String","required","unique","password","role","User","model","createAdminUser","findOne","admin","newAdmin","save","post","userId","productId","status","message","UserCliente","findById","user","favorites","includes","push","Set","map","f","toString","populate","updatedUser","get","params","before","length","filter","fav","find","users","existingUser","newUser","userClienteSchema","nombre","email","telefono","direccion","Types","ObjectId","ref","select","clientes","receivedData","existingCliente","nodemailer","transporter","createTransport","service","auth","pass","newCliente","mailOptions","from","to","subject","text","sendMail","info","response","clienteResponse","_id","cliente","code","success","findByIdAndDelete","id","deletedCliente","productSchema","codigo","Number","name","description","image","image1","image2","image3","stock","category","estado","videoURL","featuresText","tagsText","destacado","Boolean","Product","query","products","product","Object","keys","receivedHeaders","newProduct","stack","put","findByIdAndUpdate","updatedProduct","deletedProduct","ordenSchema","productos","cantidad","price","total","fecha","Date","now","Orden","nuevaOrden","resumen","p","join","mensaje","sort","ordenes","interaccionSchema","usuario","Interaccion","nueva","interacciones","cotizacionSchema","numeroCotizacion","dniRuc","telefonoMovil","contacto","categoria","equipo","precioUnitario","pdfBase64","createdAt","updatedAt","Cotizacion","countDocuments","numero","padStart","nuevaCotizacion","pdfBuffer","Buffer","process","env","EMAIL_USER","EMAIL_OWNER","html","attachments","filename","content","contentType","totalPendientes","lean","historial","forEach","cot","Array","isArray","precio","count","data","path","strictPopulate","cotizaciones","producto","productoId","imagen","cotizacionId","cotizacion","patch","estadosPermitidos","toLowerCase","runValidators","listen"],"mappings":";;;;;;;;;;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAMC,QAAQ,GAAGD,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAME,IAAI,GAAGF,OAAO,CAAC,MAAD,CAApB;;AACA,IAAMG,GAAG,GAAGJ,OAAO,EAAnB;AACA,IAAMK,IAAI,GAAG,IAAb;;AAEA,IAAMC,WAAW,GAAGL,OAAO,CAAC,QAAD,CAA3B,C,CAGA;AACA;;;AACAG,GAAG,CAACG,GAAJ,CAAQJ,IAAI,CAAC;AACXK,EAAAA,MAAM,EAAE,CAAC,uBAAD,EAA0B,uBAA1B,CADG;AACiD;AAC5DC,EAAAA,OAAO,EAAE,CAAC,KAAD,EAAQ,MAAR,EAAgB,KAAhB,EAAuB,QAAvB,EAAiC,SAAjC,CAFE;AAGXC,EAAAA,cAAc,EAAE,CAAC,cAAD,EAAiB,eAAjB;AAHL,CAAD,CAAZ;AAKAN,GAAG,CAACG,GAAJ,CAAQP,OAAO,CAACW,IAAR,CAAa;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAAb,CAAR,E,CAA0C;;AAC1CR,GAAG,CAACG,GAAJ,CAAQP,OAAO,CAACa,UAAR,CAAmB;AAAEC,EAAAA,QAAQ,EAAE,IAAZ;AAAkBF,EAAAA,KAAK,EAAE;AAAzB,CAAnB,CAAR,E,CAAgE;;AAChER,GAAG,CAACG,GAAJ,CAAQP,OAAO,CAACW,IAAR,CAAa;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAAb,CAAR,E,CAA0C;AAG1C;;AACAR,GAAG,CAACG,GAAJ,CAAQ,UAACQ,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxB,MAAIF,GAAG,CAACG,OAAJ,CAAY,cAAZ,MAAgC,YAAhC,IAAgDH,GAAG,CAACI,IAApD,IAA4D,OAAOJ,GAAG,CAACI,IAAX,KAAoB,QAApF,EAA8F;AAC1F,QAAI;AACAJ,MAAAA,GAAG,CAACI,IAAJ,GAAWC,IAAI,CAACC,KAAL,CAAWN,GAAG,CAACI,IAAf,CAAX;AACAG,MAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ,EAA6CR,GAAG,CAACI,IAAjD;AACH,KAHD,CAGE,OAAOK,CAAP,EAAU;AACRF,MAAAA,OAAO,CAACG,KAAR,CAAc,qCAAd,EAAqDD,CAArD;AACH;AACJ;;AACDP,EAAAA,IAAI;AACP,CAVD,E,CAYA;;AACA,IAAMS,KAAK,GAAG,sCAAd;AACAxB,QAAQ,CAACyB,OAAT,CAAiBD,KAAjB,EACKE,IADL,CACU;AAAA,SAAMN,OAAO,CAACC,GAAR,CAAY,mBAAZ,CAAN;AAAA,CADV,WAEW,UAAAM,GAAG;AAAA,SAAIP,OAAO,CAACG,KAAR,CAAc,2BAAd,EAA2CI,GAA3C,CAAJ;AAAA,CAFd,E,CAIA;;AACA,IAAMC,UAAU,GAAG,IAAI5B,QAAQ,CAAC6B,MAAb,CAAoB;AACnCC,EAAAA,QAAQ,EAAE;AAAEC,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE,IAA1B;AAAgCC,IAAAA,MAAM,EAAE;AAAxC,GADyB;AAEnCC,EAAAA,QAAQ,EAAE;AAAEJ,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAFyB;AAGnCG,EAAAA,IAAI,EAAE;AAAEL,IAAAA,IAAI,EAAEC,MAAR;AAAgB,eAAS;AAAzB;AAH6B,CAApB,CAAnB;AAKA,IAAMK,IAAI,GAAGrC,QAAQ,CAACsC,KAAT,CAAe,MAAf,EAAuBV,UAAvB,CAAb,C,CAEA;;AACA,SAAeW,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CACwBF,IAAI,CAACG,OAAL,CAAa;AAAEV,YAAAA,QAAQ,EAAE;AAAZ,WAAb,CADxB;;AAAA;AACUW,UAAAA,KADV;;AAAA,cAESA,KAFT;AAAA;AAAA;AAAA;;AAGcC,UAAAA,QAHd,GAGyB,IAAIL,IAAJ,CAAS;AAAEP,YAAAA,QAAQ,EAAE,OAAZ;AAAqBK,YAAAA,QAAQ,EAAE,UAA/B;AAA2CC,YAAAA,IAAI,EAAE;AAAjD,WAAT,CAHzB;AAAA;AAAA,0CAIcM,QAAQ,CAACC,IAAT,EAJd;;AAAA;AAKQvB,UAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AALR;AAAA;;AAAA;AAOQD,UAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;;AAPR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAUAkB,eAAe,G,CAEf;;AACArC,GAAG,CAAC0C,IAAJ,CAAS,YAAT,EAAuB,iBAAO/B,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEWD,GAAG,CAACI,IAFf,EAEX4B,MAFW,aAEXA,MAFW,EAEHC,SAFG,aAEHA,SAFG;;AAAA,gBAIf,CAACD,MAAD,IAAW,CAACC,SAJG;AAAA;AAAA;AAAA;;AAAA,4CAKVhC,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CALU;;AAAA;AAAA;AAAA,0CAQAC,WAAW,CAACC,QAAZ,CAAqBL,MAArB,CARA;;AAAA;AAQbM,UAAAA,IARa;;AAAA,cASdA,IATc;AAAA;AAAA;AAAA;;AAAA,4CASDrC,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CATC;;AAAA;AAAA,cAWdG,IAAI,CAACC,SAAL,CAAeC,QAAf,CAAwBP,SAAxB,CAXc;AAAA;AAAA;AAAA;;AAYjBK,UAAAA,IAAI,CAACC,SAAL,CAAeE,IAAf,CAAoBR,SAApB;AACAK,UAAAA,IAAI,CAACC,SAAL,sBAAqB,IAAIG,GAAJ,CAAQJ,IAAI,CAACC,SAAL,CAAeI,GAAf,CAAmB,UAAAC,CAAC;AAAA,mBAAIA,CAAC,CAACC,QAAF,EAAJ;AAAA,WAApB,CAAR,CAArB;AAbiB;AAAA,0CAcXP,IAAI,CAACR,IAAL,EAdW;;AAAA;AAAA;AAAA,0CAiBOM,WAAW,CAACC,QAAZ,CAAqBL,MAArB,EAA6Bc,QAA7B,CAAsC,WAAtC,CAjBP;;AAAA;AAiBbC,UAAAA,WAjBa;AAiB2D;AAC9E9C,UAAAA,GAAG,CAACL,IAAJ,CAAS;AACPuC,YAAAA,OAAO,EAAE,+BADF;AAEPI,YAAAA,SAAS,EAAEQ,WAAW,CAACR;AAFhB,WAAT;AAlBmB;AAAA;;AAAA;AAAA;AAAA;AAuBnBhC,UAAAA,OAAO,CAACG,KAAR,CAAc,6BAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,8BAAX;AAA2CzB,YAAAA,KAAK,EAAE,aAAIyB;AAAtD,WAArB;;AAxBmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAvB,E,CA4BA;;AACA9C,GAAG,CAAC2D,GAAJ,CAAQ,oBAAR,EAA8B,kBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAElB+B,UAAAA,MAFkB,GAEPhC,GAAG,CAACiD,MAFG,CAElBjB,MAFkB;AAAA;AAAA,0CAIPI,WAAW,CAACC,QAAZ,CAAqBL,MAArB,EAA6Bc,QAA7B,CAAsC,WAAtC,CAJO;;AAAA;AAIpBR,UAAAA,IAJoB;;AAAA,cAKrBA,IALqB;AAAA;AAAA;AAAA;;AAAA,4CAKRrC,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CALQ;;AAAA;AAO1BlC,UAAAA,GAAG,CAACL,IAAJ,CAAS;AACPuC,YAAAA,OAAO,EAAE,mCADF;AAEPI,YAAAA,SAAS,EAAED,IAAI,CAACC;AAFT,WAAT;AAP0B;AAAA;;AAAA;AAAA;AAAA;AAY1BhC,UAAAA,OAAO,CAACG,KAAR,CAAc,oCAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,4BAAX;AAAyCzB,YAAAA,KAAK,EAAE,aAAIyB;AAApD,WAArB;;AAb0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA9B,E,CAiBA;;AACA9C,GAAG,UAAH,CAAW,+BAAX,EAA4C,kBAAOW,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAEVD,GAAG,CAACiD,MAFM,EAEhCjB,MAFgC,eAEhCA,MAFgC,EAExBC,SAFwB,eAExBA,SAFwB;AAAA;AAAA,0CAIrBG,WAAW,CAACC,QAAZ,CAAqBL,MAArB,CAJqB;;AAAA;AAIlCM,UAAAA,IAJkC;;AAAA,cAKnCA,IALmC;AAAA;AAAA;AAAA;;AAAA,4CAKtBrC,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CALsB;;AAAA;AAOlCe,UAAAA,MAPkC,GAOzBZ,IAAI,CAACC,SAAL,CAAeY,MAPU;AAQxCb,UAAAA,IAAI,CAACC,SAAL,GAAiBD,IAAI,CAACC,SAAL,CAAea,MAAf,CAAsB,UAAAC,GAAG;AAAA,mBAAIA,GAAG,CAACR,QAAJ,OAAmBZ,SAAvB;AAAA,WAAzB,CAAjB;;AARwC,gBAUpCiB,MAAM,KAAKZ,IAAI,CAACC,SAAL,CAAeY,MAVU;AAAA;AAAA;AAAA;;AAAA,4CAW/BlD,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CAX+B;;AAAA;AAAA;AAAA,0CAclCG,IAAI,CAACR,IAAL,EAdkC;;AAAA;AAAA;AAAA,0CAedM,WAAW,CAACC,QAAZ,CAAqBL,MAArB,EAA6Bc,QAA7B,CAAsC,WAAtC,CAfc;;AAAA;AAelCC,UAAAA,WAfkC;AAesC;AAE9E9C,UAAAA,GAAG,CAACL,IAAJ,CAAS;AACPuC,YAAAA,OAAO,EAAE,iCADF;AAEPI,YAAAA,SAAS,EAAEQ,WAAW,CAACR;AAFhB,WAAT;AAjBwC;AAAA;;AAAA;AAAA;AAAA;AAsBxChC,UAAAA,OAAO,CAACG,KAAR,CAAc,kDAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,gCAAX;AAA6CzB,YAAAA,KAAK,EAAE,aAAIyB;AAAxD,WAArB;;AAvBwC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA5C,E,CAkCA;;AACA9C,GAAG,CAAC2D,GAAJ,CAAQ,QAAR,EAAkB,kBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEUuB,IAAI,CAAC8B,IAAL,EAFV;;AAAA;AAEJC,UAAAA,KAFI;AAGVtD,UAAAA,GAAG,CAACL,IAAJ,CAAS2D,KAAT;AAHU;AAAA;;AAAA;AAAA;AAAA;AAKVtD,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,2BAAX;AAAwCzB,YAAAA,KAAK;AAA7C,WAArB;;AALU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAlB;AASArB,GAAG,CAAC0C,IAAJ,CAAS,QAAT,EAAmB,kBAAO/B,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,uBACgBD,GAAG,CAACI,IADpB,EACPa,QADO,cACPA,QADO,EACGK,QADH,cACGA,QADH;AAAA;AAAA,0CAEIE,IAAI,CAACG,OAAL,CAAa;AAAEV,YAAAA,QAAQ,EAARA,QAAF;AAAYK,YAAAA,QAAQ,EAARA;AAAZ,WAAb,CAFJ;;AAAA;AAETgB,UAAAA,IAFS;;AAGf,cAAIA,IAAJ,EAAU;AACNrC,YAAAA,GAAG,CAACL,IAAJ,CAAS;AAAEuC,cAAAA,OAAO,EAAE,kBAAX;AAA+BG,cAAAA,IAAI,EAAJA;AAA/B,aAAT;AACH,WAFD,MAEO;AACHrC,YAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,cAAAA,OAAO,EAAE;AAAX,aAArB;AACH;;AAPc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAnB,E,CAUA;;AACA9C,GAAG,CAAC0C,IAAJ,CAAS,WAAT,EAAsB,kBAAO/B,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,uBACaD,GAAG,CAACI,IADjB,EACVa,QADU,cACVA,QADU,EACAK,QADA,cACAA,QADA;AAAA;AAAA;AAAA,0CAGaE,IAAI,CAACG,OAAL,CAAa;AAAEV,YAAAA,QAAQ,EAARA;AAAF,WAAb,CAHb;;AAAA;AAGRuC,UAAAA,YAHQ;;AAAA,eAIVA,YAJU;AAAA;AAAA;AAAA;;AAAA,4CAKHvD,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CALG;;AAAA;AAQRsB,UAAAA,OARQ,GAQE,IAAIjC,IAAJ,CAAS;AAAEP,YAAAA,QAAQ,EAARA,QAAF;AAAYK,YAAAA,QAAQ,EAARA,QAAZ;AAAsBC,YAAAA,IAAI,EAAE;AAA5B,WAAT,CARF;AAAA;AAAA,0CASRkC,OAAO,CAAC3B,IAAR,EATQ;;AAAA;AAUd7B,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,kCAAX;AAA+CG,YAAAA,IAAI,EAAEmB;AAArD,WAArB;AAVc;AAAA;;AAAA;AAAA;AAAA;AAYdxD,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,4BAAX;AAAyCzB,YAAAA,KAAK;AAA9C,WAArB;;AAZc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAtB,E,CAsBA;;AAGA,IAAMgD,iBAAiB,GAAG,IAAIvE,QAAQ,CAAC6B,MAAb,CAAoB;AAC5CM,EAAAA,QAAQ,EAAE;AAAEJ,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GADkC;AAE5CuC,EAAAA,MAAM,EAAE;AAAEzC,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAFoC;AAG5CwC,EAAAA,KAAK,EAAE;AAAE1C,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE,IAA1B;AAAgCC,IAAAA,MAAM,EAAE;AAAxC,GAHqC;AAI5CwC,EAAAA,QAAQ,EAAE;AAAE3C,IAAAA,IAAI,EAAEC;AAAR,GAJkC;AAK5C2C,EAAAA,SAAS,EAAE;AAAE5C,IAAAA,IAAI,EAAEC;AAAR,GALiC;AAM1CoB,EAAAA,SAAS,EAAE,CAAC;AAAErB,IAAAA,IAAI,EAAE/B,QAAQ,CAAC6B,MAAT,CAAgB+C,KAAhB,CAAsBC,QAA9B;AAAwCC,IAAAA,GAAG,EAAE;AAA7C,GAAD,CAN+B,CAM4B;;AAN5B,CAApB,CAA1B;AAUA,IAAM7B,WAAW,GAAGjD,QAAQ,CAACsC,KAAT,CAAe,aAAf,EAA8BiC,iBAA9B,CAApB;AAEArE,GAAG,CAAC2D,GAAJ,CAAQ,WAAR,EAAqB,kBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEUmC,WAAW,CAACkB,IAAZ,GAAmBY,MAAnB,CAA0B,WAA1B,CAFV;;AAAA;AAEPC,UAAAA,QAFO;AAEkD;AAC/DlE,UAAAA,GAAG,CAACL,IAAJ,CAASuE,QAAT;AAHa;AAAA;;AAAA;AAAA;AAAA;AAKblE,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,2BAAX;AAAwCzB,YAAAA,KAAK,EAAE,aAAIyB;AAAnD,WAArB;;AALa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAArB,E,CAUA;;AACA9C,GAAG,CAAC0C,IAAJ,CAAS,oBAAT,EAA+B,kBAAO/B,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEvBM,UAAAA,OAAO,CAACC,GAAR,CAAY,gCAAZ,EAA8CR,GAAG,CAACI,IAAlD;AAFuB,uBAIkCJ,GAAG,CAACI,IAJtC,EAIfkB,QAJe,cAIfA,QAJe,EAILqC,MAJK,cAILA,MAJK,EAIGC,KAJH,cAIGA,KAJH,EAIUC,QAJV,cAIUA,QAJV,EAIoBC,SAJpB,cAIoBA,SAJpB,EAMvB;;AANuB,gBAOnB,CAACxC,QAAD,IAAa,CAACqC,MAAd,IAAwB,CAACC,KAPN;AAAA;AAAA;AAAA;;AAAA,4CAQZ3D,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACxBuC,YAAAA,OAAO,EAAE,2CADe;AAExBiC,YAAAA,YAAY,EAAEpE,GAAG,CAACI;AAFM,WAArB,CARY;;AAAA;AAAA;AAAA,0CAeOgC,WAAW,CAACT,OAAZ,CAAoB;AAAEiC,YAAAA,KAAK,EAALA;AAAF,WAApB,CAfP;;AAAA;AAejBS,UAAAA,eAfiB;;AAAA,eAgBnBA,eAhBmB;AAAA;AAAA;AAAA;;AAAA,4CAiBZpE,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CAjBY;;AAAA;AAmBjBmC,UAAAA,WAnBiB,GAmBJpF,OAAO,CAAC,YAAD,CAnBH,EAqB/B;;AACMqF,UAAAA,YAtByB,GAsBXD,WAAU,CAACE,eAAX,CAA2B;AAC7CC,YAAAA,OAAO,EAAE,OADoC;AAE7CC,YAAAA,IAAI,EAAE;AACJpC,cAAAA,IAAI,EAAE,+BADF;AACmC;AACvCqC,cAAAA,IAAI,EAAE,kBAFF,CAEuB;;AAFvB;AAFuC,WAA3B,CAtBW,EA+BvB;;AACMC,UAAAA,UAhCiB,GAgCJ,IAAIxC,WAAJ,CAAgB;AAC/Bd,YAAAA,QAAQ,EAARA,QAD+B;AAE/BqC,YAAAA,MAAM,EAANA,MAF+B;AAG/BC,YAAAA,KAAK,EAALA,KAH+B;AAI/BC,YAAAA,QAAQ,EAAEA,QAAQ,IAAI,EAJS;AAK/BC,YAAAA,SAAS,EAAEA,SAAS,IAAI;AALO,WAAhB,CAhCI;AAAA;AAAA,0CAwCjBc,UAAU,CAAC9C,IAAX,EAxCiB;;AAAA;AA0C/B;AACM+C,UAAAA,WA3CyB,GA2CX;AAClBC,YAAAA,IAAI,EAAE,+BADY;AAElBC,YAAAA,EAAE,EAAEnB,KAFc;AAGlBoB,YAAAA,OAAO,EAAE,8BAHS;AAIlBC,YAAAA,IAAI,qBAAWtB,MAAX;AAJc,WA3CW;;AA2D/BY,UAAAA,YAAW,CAACW,QAAZ,CAAqBL,WAArB,EAAkC,UAACnE,KAAD,EAAQyE,IAAR,EAAiB;AACjD,gBAAIzE,KAAJ,EAAW;AACTH,cAAAA,OAAO,CAACG,KAAR,CAAc,yBAAd,EAAyCA,KAAzC;AACD,aAFD,MAEO;AACLH,cAAAA,OAAO,CAACC,GAAR,CAAY,qBAAqB2E,IAAI,CAACC,QAAtC;AACD;AACF,WAND,EA3D+B,CAoEvB;;;AACMC,UAAAA,eArEiB,GAqEC;AACpBC,YAAAA,GAAG,EAAEV,UAAU,CAACU,GADI;AAEpB3B,YAAAA,MAAM,EAAEiB,UAAU,CAACjB,MAFC;AAGpBC,YAAAA,KAAK,EAAEgB,UAAU,CAAChB,KAHE;AAIpBC,YAAAA,QAAQ,EAAEe,UAAU,CAACf,QAJD;AAKpBC,YAAAA,SAAS,EAAEc,UAAU,CAACd;AALF,WArED;AA6EvB7D,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACjBuC,YAAAA,OAAO,EAAE,kCADQ;AAEjBoD,YAAAA,OAAO,EAAEF;AAFQ,WAArB;AA7EuB;AAAA;;AAAA;AAAA;AAAA;AAkFvB9E,UAAAA,OAAO,CAACG,KAAR,CAAc,4BAAd;;AACA,cAAI,aAAI8E,IAAJ,KAAa,KAAjB,EAAwB;AACpB;AACAvF,YAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,cAAAA,OAAO,EAAE;AAAX,aAArB;AACH,WAHD,MAGO;AACHlC,YAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,cAAAA,OAAO,EAAE,4BAAX;AAAyCzB,cAAAA,KAAK,EAAE,aAAIyB;AAApD,aAArB;AACH;;AAxFsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA/B,E,CA4FA;;AACA9C,GAAG,CAAC0C,IAAJ,CAAS,iBAAT,EAA4B,kBAAO/B,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEpBM,UAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCR,GAAG,CAACI,IAArC;AAFoB,uBAIQJ,GAAG,CAACI,IAJZ,EAIZwD,KAJY,cAIZA,KAJY,EAILtC,QAJK,cAILA,QAJK,EAMpB;;AANoB,gBAOhB,CAACsC,KAAD,IAAU,CAACtC,QAPK;AAAA;AAAA;AAAA;;AAAA,6CAQTrB,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CARS;;AAAA;AAAA;AAAA,0CAYEC,WAAW,CAACT,OAAZ,CAAoB;AAAEiC,YAAAA,KAAK,EAALA,KAAF;AAAStC,YAAAA,QAAQ,EAARA;AAAT,WAApB,CAZF;;AAAA;AAYdiE,UAAAA,OAZc;;AAcpB,cAAIA,OAAJ,EAAa;AACT;AACMF,YAAAA,eAFG,GAEe;AACpBC,cAAAA,GAAG,EAAEC,OAAO,CAACD,GADO;AAEpB3B,cAAAA,MAAM,EAAE4B,OAAO,CAAC5B,MAFI;AAGpBC,cAAAA,KAAK,EAAE2B,OAAO,CAAC3B,KAHK;AAIpBC,cAAAA,QAAQ,EAAE0B,OAAO,CAAC1B,QAJE;AAKpBC,cAAAA,SAAS,EAAEyB,OAAO,CAACzB;AALC,aAFf;AAUT7D,YAAAA,GAAG,CAACL,IAAJ,CAAS;AACLuC,cAAAA,OAAO,EAAE,eADJ;AAELoD,cAAAA,OAAO,EAAEF,eAFJ;AAGLI,cAAAA,OAAO,EAAE;AAHJ,aAAT;AAKH,WAfD,MAeO;AACHxF,YAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACjBuC,cAAAA,OAAO,EAAE,wBADQ;AAEjBsD,cAAAA,OAAO,EAAE;AAFQ,aAArB;AAIH;;AAlCmB;AAAA;;AAAA;AAAA;AAAA;AAoCpBlF,UAAAA,OAAO,CAACG,KAAR,CAAc,iBAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,sBAAX;AAAmCzB,YAAAA,KAAK,EAAE,cAAIyB;AAA9C,WAArB;;AArCoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA5B,E,CA0CA;;AACA9C,GAAG,UAAH,CAAW,eAAX,EAA4B,mBAAOW,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAESmC,WAAW,CAACsD,iBAAZ,CAA8B1F,GAAG,CAACiD,MAAJ,CAAW0C,EAAzC,CAFT;;AAAA;AAEdC,UAAAA,cAFc;;AAAA,cAIfA,cAJe;AAAA;AAAA;AAAA;;AAAA,6CAKT3F,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CALS;;AAAA;AAQpBlC,UAAAA,GAAG,CAACL,IAAJ,CAAS;AACLuC,YAAAA,OAAO,EAAE,iCADJ;AAELoD,YAAAA,OAAO,EAAE;AACLD,cAAAA,GAAG,EAAEM,cAAc,CAACN,GADf;AAEL3B,cAAAA,MAAM,EAAEiC,cAAc,CAACjC,MAFlB;AAGLC,cAAAA,KAAK,EAAEgC,cAAc,CAAChC;AAHjB;AAFJ,WAAT;AARoB;AAAA;;AAAA;AAAA;AAAA;AAiBpBrD,UAAAA,OAAO,CAACG,KAAR,CAAc,2BAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,0BAAX;AAAuCzB,YAAAA,KAAK,EAAE,cAAIyB;AAAlD,WAArB;;AAlBoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA5B,E,CA4BA;;AACA,IAAMmC,UAAU,GAAGpF,OAAO,CAAC,YAAD,CAA1B,C,CAEA;;;AACA,IAAMqF,WAAW,GAAGD,UAAU,CAACE,eAAX,CAA2B;AAC7CC,EAAAA,OAAO,EAAE,OADoC;AAE7CC,EAAAA,IAAI,EAAE;AACJpC,IAAAA,IAAI,EAAE,+BADF;AAEJqC,IAAAA,IAAI,EAAE;AAFF;AAFuC,CAA3B,CAApB,C,CAQA;AAEA;;AACA,IAAMkB,aAAa,GAAG,IAAI1G,QAAQ,CAAC6B,MAAb,CAAoB;AACxC8E,EAAAA,MAAM,EAAE;AAAE5E,IAAAA,IAAI,EAAE6E,MAAR;AAAgB3E,IAAAA,QAAQ,EAAE;AAA1B,GADgC;AAExC4E,EAAAA,IAAI,EAAE;AAAE9E,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAFkC;AAGxC6E,EAAAA,WAAW,EAAE;AAAE/E,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAH2B;AAIxC8E,EAAAA,KAAK,EAAE;AAAEhF,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAJiC;AAKxC+E,EAAAA,MAAM,EAAE;AAAEjF,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GALgC;AAMxCgF,EAAAA,MAAM,EAAE;AAAElF,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GANgC;AAOxCiF,EAAAA,MAAM,EAAE;AAAEnF,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAPgC;AAQxCkF,EAAAA,KAAK,EAAE;AAAEpF,IAAAA,IAAI,EAAE6E,MAAR;AAAgB3E,IAAAA,QAAQ,EAAE;AAA1B,GARiC;AASxCmF,EAAAA,QAAQ,EAAE;AAAErF,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAT8B;AAUxCoF,EAAAA,MAAM,EAAE;AACNtF,IAAAA,IAAI,EAAEC,MADA;AAEN,YAAM,CAAC,QAAD,EAAW,QAAX,CAFA;AAEsB;AAC5BC,IAAAA,QAAQ,EAAE;AAHJ,GAVgC;AAexCqF,EAAAA,QAAQ,EAAE;AAAEvF,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAf8B;AAgBxCsF,EAAAA,YAAY,EAAE;AAAExF,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAhB0B;AAiBxCuF,EAAAA,QAAQ,EAAE;AAAEzF,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAjB8B;AAkBxCwF,EAAAA,SAAS,EAAE;AAAE1F,IAAAA,IAAI,EAAE2F,OAAR;AAAiB,eAAS;AAA1B;AAlB6B,CAApB,CAAtB;AAqBA,IAAMC,OAAO,GAAG3H,QAAQ,CAACsC,KAAT,CAAe,SAAf,EAA0BoE,aAA1B,CAAhB,C,CAEA;AAEA;;AACAxG,GAAG,CAAC2D,GAAJ,CAAQ,WAAR,EAAqB,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEYD,GAAG,CAAC+G,KAFhB,EAETR,QAFS,cAETA,QAFS,EAECC,MAFD,cAECA,MAFD;AAIXO,UAAAA,KAJW,GAIH,EAJG;AAKjB,cAAIR,QAAJ,EAAcQ,KAAK,CAACR,QAAN,GAAiBA,QAAjB;AACd,cAAIC,MAAJ,EAAYO,KAAK,CAACP,MAAN,GAAeA,MAAf,CANK,CAMkB;;AANlB;AAAA,0CAQMM,OAAO,CAACxD,IAAR,CAAayD,KAAb,CARN;;AAAA;AAQXC,UAAAA,QARW;AASjB/G,UAAAA,GAAG,CAACL,IAAJ,CAASoH,QAAT;AATiB;AAAA;;AAAA;AAAA;AAAA;AAWjB/G,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,yBAAX;AAAsCzB,YAAAA,KAAK;AAA3C,WAArB;;AAXiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAArB,E,CAeA;;AACArB,GAAG,CAAC2D,GAAJ,CAAQ,eAAR,EAAyB,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEC6G,OAAO,CAACzE,QAAR,CAAiBrC,GAAG,CAACiD,MAAJ,CAAW0C,EAA5B,CAFD;;AAAA;AAEfsB,UAAAA,OAFe;;AAAA,cAGhBA,OAHgB;AAAA;AAAA;AAAA;;AAAA,6CAGAhH,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CAHA;;AAAA;AAIrBlC,UAAAA,GAAG,CAACL,IAAJ,CAASqH,OAAT;AAJqB;AAAA;;AAAA;AAAA;AAAA;AAMrBhH,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,wBAAX;AAAqCzB,YAAAA,KAAK;AAA1C,WAArB;;AANqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAzB,E,CAUA;;AACArB,GAAG,CAAC0C,IAAJ,CAAS,WAAT,EAAsB,mBAAO/B,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAElBM,UAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;AACAD,UAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBR,GAAG,CAACI,IAAzB;;AAHkB,gBAKd,CAACJ,GAAG,CAACI,IAAL,IAAa8G,MAAM,CAACC,IAAP,CAAYnH,GAAG,CAACI,IAAhB,EAAsB+C,MAAtB,KAAiC,CALhC;AAAA;AAAA;AAAA;;AAAA,6CAMTlD,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1BuC,YAAAA,OAAO,EAAE,wCADiB;AAE1BiF,YAAAA,eAAe,EAAEpH,GAAG,CAACG;AAFK,WAArB,CANS;;AAAA;AAAA,uBA2BdH,GAAG,CAACI,IA3BU,EAahB0F,MAbgB,cAahBA,MAbgB,EAchBE,IAdgB,cAchBA,IAdgB,EAehBC,WAfgB,cAehBA,WAfgB,EAgBhBC,KAhBgB,cAgBhBA,KAhBgB,EAiBhBC,MAjBgB,cAiBhBA,MAjBgB,EAkBhBC,MAlBgB,cAkBhBA,MAlBgB,EAmBhBC,MAnBgB,cAmBhBA,MAnBgB,EAoBhBC,KApBgB,cAoBhBA,KApBgB,EAqBhBC,QArBgB,cAqBhBA,QArBgB,EAsBhBC,MAtBgB,cAsBhBA,MAtBgB,EAuBhBC,QAvBgB,cAuBhBA,QAvBgB,EAwBhBC,YAxBgB,cAwBhBA,YAxBgB,EAyBhBC,QAzBgB,cAyBhBA,QAzBgB,EA0BhBC,SA1BgB,cA0BhBA,SA1BgB,EA6BlB;;AA7BkB,gBA8Bd,CAACd,MAAD,IAAW,CAACE,IAAZ,IAAoB,CAACC,WAArB,IAAoC,CAACC,KAArC,IAA8C,CAACI,KAA/C,IAAwD,CAACC,QAAzD,IAAqE,CAACC,MA9BxD;AAAA;AAAA;AAAA;;AAAA,6CA+BTvG,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1BuC,YAAAA,OAAO,EAAE,4BADiB;AAE1BiC,YAAAA,YAAY,EAAEpE,GAAG,CAACI;AAFQ,WAArB,CA/BS;;AAAA;AAqCZiH,UAAAA,UArCY,GAqCC,IAAIP,OAAJ,CAAY;AAC7BhB,YAAAA,MAAM,EAANA,MAD6B;AAE7BE,YAAAA,IAAI,EAAJA,IAF6B;AAG7BC,YAAAA,WAAW,EAAXA,WAH6B;AAI7BC,YAAAA,KAAK,EAALA,KAJ6B;AAK7BC,YAAAA,MAAM,EAANA,MAL6B;AAM7BC,YAAAA,MAAM,EAANA,MAN6B;AAO7BC,YAAAA,MAAM,EAANA,MAP6B;AAQ7BC,YAAAA,KAAK,EAALA,KAR6B;AAS7BC,YAAAA,QAAQ,EAARA,QAT6B;AAU7BC,YAAAA,MAAM,EAANA,MAV6B;AAW7BC,YAAAA,QAAQ,EAARA,QAX6B;AAY7BC,YAAAA,YAAY,EAAZA,YAZ6B;AAa7BC,YAAAA,QAAQ,EAARA,QAb6B;AAc7BC,YAAAA,SAAS,EAATA;AAd6B,WAAZ,CArCD;AAAA;AAAA,0CAsDZS,UAAU,CAACvF,IAAX,EAtDY;;AAAA;AAuDlBvB,UAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ,EAAkD6G,UAAlD;AACApH,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqByH,UAArB;AAxDkB;AAAA;;AAAA;AAAA;AAAA;AA0DlB9G,UAAAA,OAAO,CAACG,KAAR,CAAc,4BAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnBuC,YAAAA,OAAO,EAAE,wBADU;AAEnBzB,YAAAA,KAAK,EAAE,cAAIyB,OAAJ,iBAFY;AAGnBmF,YAAAA,KAAK,EAAE,cAAIA;AAHQ,WAArB;;AA3DkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAtB,E,CAmEA;;AACAjI,GAAG,CAACkI,GAAJ,CAAQ,eAAR,EAAyB,mBAAOvH,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEQ6G,OAAO,CAACU,iBAAR,CAA0BxH,GAAG,CAACiD,MAAJ,CAAW0C,EAArC,EAAyC3F,GAAG,CAACI,IAA7C,EAAmD;AAAE,mBAAK;AAAP,WAAnD,CAFR;;AAAA;AAEfqH,UAAAA,cAFe;;AAAA,cAGhBA,cAHgB;AAAA;AAAA;AAAA;;AAAA,6CAGOxH,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CAHP;;AAAA;AAIrBlC,UAAAA,GAAG,CAACL,IAAJ,CAAS6H,cAAT;AAJqB;AAAA;;AAAA;AAAA;AAAA;AAMrBxH,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,wBAAX;AAAqCzB,YAAAA,KAAK;AAA1C,WAArB;;AANqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAzB,E,CAUA;;AACArB,GAAG,UAAH,CAAW,eAAX,EAA4B,mBAAOW,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEK6G,OAAO,CAACpB,iBAAR,CAA0B1F,GAAG,CAACiD,MAAJ,CAAW0C,EAArC,CAFL;;AAAA;AAElB+B,UAAAA,cAFkB;;AAAA,cAGnBA,cAHmB;AAAA;AAAA;AAAA;;AAAA,6CAGIzH,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB,CAHJ;;AAAA;AAIxBlC,UAAAA,GAAG,CAACL,IAAJ,CAAS;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAAT;AAJwB;AAAA;;AAAA;AAAA;AAAA;AAMxBlC,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,wBAAX;AAAqCzB,YAAAA,KAAK;AAA1C,WAArB;;AANwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA5B,E,CAoBA;;AAGA,IAAMiH,WAAW,GAAG,IAAIxI,QAAQ,CAAC6B,MAAb,CAAoB;AACtC2C,EAAAA,MAAM,EAAExC,MAD8B;AAEtCyC,EAAAA,KAAK,EAAEzC,MAF+B;AAGtCyG,EAAAA,SAAS,EAAE,CACT;AACE5B,IAAAA,IAAI,EAAE7E,MADR;AAEE0G,IAAAA,QAAQ,EAAE9B,MAFZ;AAGE+B,IAAAA,KAAK,EAAE/B;AAHT,GADS,CAH2B;AAUtCgC,EAAAA,KAAK,EAAEhC,MAV+B;AAWtCiC,EAAAA,KAAK,EAAE;AACL9G,IAAAA,IAAI,EAAE+G,IADD;AAEL,eAASA,IAAI,CAACC;AAFT;AAX+B,CAApB,CAApB;AAiBA,IAAMC,KAAK,GAAGhJ,QAAQ,CAACsC,KAAT,CAAe,OAAf,EAAwBkG,WAAxB,CAAd;AAGAtI,GAAG,CAAC0C,IAAJ,CAAS,UAAT,EAAqB,mBAAO/B,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAE2BD,GAAG,CAACI,IAF/B,EAETuD,MAFS,cAETA,MAFS,EAEDC,KAFC,cAEDA,KAFC,EAEMgE,SAFN,cAEMA,SAFN,EAEiBG,KAFjB,cAEiBA,KAFjB,EAIjB;;AACMK,UAAAA,UALW,GAKE,IAAID,KAAJ,CAAU;AAAExE,YAAAA,MAAM,EAANA,MAAF;AAAUC,YAAAA,KAAK,EAALA,KAAV;AAAiBgE,YAAAA,SAAS,EAATA,SAAjB;AAA4BG,YAAAA,KAAK,EAALA;AAA5B,WAAV,CALF;AAAA;AAAA,0CAMXK,UAAU,CAACtG,IAAX,EANW;;AAAA;AAQjB;AACMuG,UAAAA,OATW,GASDT,SAAS,CACtBjF,GADa,CACT,UAAA2F,CAAC;AAAA,+BAASA,CAAC,CAACtC,IAAX,gBAAqBsC,CAAC,CAACT,QAAvB,oBAAyCS,CAAC,CAACR,KAAF,GAAUQ,CAAC,CAACT,QAArD;AAAA,WADQ,EAEbU,IAFa,CAER,IAFQ,CATC;AAaXC,UAAAA,OAbW,kBAaO7E,MAbP,gEAamE0E,OAbnE,2BAa2FN,KAb3F,kCAejB;;AAfiB;AAAA,0CAgBXxD,WAAW,CAACW,QAAZ,CAAqB;AACzBJ,YAAAA,IAAI,EAAE,oBADmB;AACG;AAC5BC,YAAAA,EAAE,EAAEnB,KAFqB;AAGzBoB,YAAAA,OAAO,EAAE,8EAHgB;AAIzBC,YAAAA,IAAI,EAAEuD;AAJmB,WAArB,CAhBW;;AAAA;AAuBjBvI,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB;AAvBiB;AAAA;;AAAA;AAAA;AAAA;AAyBjB5B,UAAAA,OAAO,CAACG,KAAR,CAAc,2BAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB;;AA1BiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAArB;AA8BA9C,GAAG,CAAC2D,GAAJ,CAAQ,UAAR,EAAoB,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEMkI,KAAK,CAAC7E,IAAN,GAAamF,IAAb,CAAkB;AAAET,YAAAA,KAAK,EAAE,CAAC;AAAV,WAAlB,CAFN;;AAAA;AAEVU,UAAAA,OAFU;AAEwC;AACxDzI,UAAAA,GAAG,CAACL,IAAJ,CAAS8I,OAAT;AAHgB;AAAA;;AAAA;AAAA;AAAA;AAKhBzI,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB;;AALgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAApB,E,CAaA;AACA;;AACA,IAAMwG,iBAAiB,GAAG,IAAIxJ,QAAQ,CAAC6B,MAAb,CAAoB;AAC5C4H,EAAAA,OAAO,EAAEzH,MADmC;AAE5CqH,EAAAA,OAAO,EAAErH,MAFmC;AAG5C6G,EAAAA,KAAK,EAAEC;AAHqC,CAApB,CAA1B;AAMA,IAAMY,WAAW,GAAG1J,QAAQ,CAACsC,KAAT,CAAe,aAAf,EAA8BkH,iBAA9B,CAApB,C,CAEA;;AACAtJ,GAAG,CAAC0C,IAAJ,CAAS,gBAAT,EAA2B,mBAAO/B,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEjB6I,UAAAA,KAFiB,GAET,IAAID,WAAJ,CAAgB7I,GAAG,CAACI,IAApB,CAFS;AAAA;AAAA,0CAGjB0I,KAAK,CAAChH,IAAN,EAHiB;;AAAA;AAIvB7B,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB;AAJuB;AAAA;;AAAA;AAAA;AAAA;AAMvBlC,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEc,YAAAA,KAAK,EAAE;AAAT,WAArB;;AANuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA3B,E,CAUA;;AACArB,GAAG,CAAC2D,GAAJ,CAAQ,gBAAR,EAA0B,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEM4I,WAAW,CAACvF,IAAZ,GAAmBmF,IAAnB,CAAwB;AAAET,YAAAA,KAAK,EAAE,CAAC;AAAV,WAAxB,CAFN;;AAAA;AAEhBe,UAAAA,aAFgB;AAGtB9I,UAAAA,GAAG,CAACL,IAAJ,CAASmJ,aAAT;AAHsB;AAAA;;AAAA;AAAA;AAAA;AAKtB9I,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEc,YAAAA,KAAK,EAAE;AAAT,WAArB;;AALsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA1B,E,CAcA;;AAEA,IAAMsI,gBAAgB,GAAG,IAAI7J,QAAQ,CAAC6B,MAAb,CAAoB;AAC3CiI,EAAAA,gBAAgB,EAAE;AAAE/H,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE,IAA1B;AAAgCC,IAAAA,MAAM,EAAE;AAAxC,GADyB;AAE7CW,EAAAA,MAAM,EAAE;AAAEd,IAAAA,IAAI,EAAE/B,QAAQ,CAAC6B,MAAT,CAAgB+C,KAAhB,CAAsBC,QAA9B;AAAwCC,IAAAA,GAAG,EAAE,aAA7C;AAA4D7C,IAAAA,QAAQ,EAAE;AAAtE,GAFqC;AAG3CuC,EAAAA,MAAM,EAAExC,MAHmC;AAI3C+H,EAAAA,MAAM,EAAE/H,MAJmC;AAK3CyC,EAAAA,KAAK,EAAEzC,MALoC;AAM3CgI,EAAAA,aAAa,EAAEhI,MAN4B;AAO3CqH,EAAAA,OAAO,EAAErH,MAPkC;AAQ3CiI,EAAAA,QAAQ,EAAEjI,MARiC;AAS3CyG,EAAAA,SAAS,EAAE,CACT;AACEyB,IAAAA,SAAS,EAAElI,MADb;AAEEmI,IAAAA,MAAM,EAAEnI,MAFV;AAGE0G,IAAAA,QAAQ,EAAE9B,MAHZ;AAIEwD,IAAAA,cAAc,EAAExD;AAJlB,GADS,CATgC;AAiB3CyD,EAAAA,SAAS,EAAErI,MAjBgC;AAkB3C6G,EAAAA,KAAK,EAAE;AAAE9G,IAAAA,IAAI,EAAE+G,IAAR;AAAc,eAASA,IAAI,CAACC;AAA5B,GAlBoC;AAmB3C1B,EAAAA,MAAM,EAAE;AAAEtF,IAAAA,IAAI,EAAEC,MAAR;AAAgB,eAAS;AAAzB,GAnBmC;AAmBK;AAChDsI,EAAAA,SAAS,EAAE;AAAEvI,IAAAA,IAAI,EAAE+G,IAAR;AAAc,eAASA,IAAI,CAACC;AAA5B,GApBgC;AAqB3CwB,EAAAA,SAAS,EAAE;AAAExI,IAAAA,IAAI,EAAE+G,IAAR;AAAc,eAASA,IAAI,CAACC;AAA5B;AArBgC,CAApB,CAAzB;AA0BA,IAAMyB,UAAU,GAAGxK,QAAQ,CAACsC,KAAT,CAAe,YAAf,EAA6BuH,gBAA7B,CAAnB,C,CAIA;AAEA;;AACA3J,GAAG,CAAC0C,IAAJ,CAAS,eAAT,EAA0B,mBAAO/B,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEtBM,UAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ,EAFsB,CAItB;;AACIyI,UAAAA,gBALkB,GAKCjJ,GAAG,CAACI,IAAJ,CAAS6I,gBALV;;AAAA,cAOjBA,gBAPiB;AAAA;AAAA;AAAA;;AAAA;AAAA,0CAQAU,UAAU,CAACC,cAAX,EARA;;AAAA;AAQd7B,UAAAA,KARc;AASd8B,UAAAA,MATc,GASL9B,KAAK,GAAG,CATH;AAUpBkB,UAAAA,gBAAgB,iBAAUY,MAAM,CAAChH,QAAP,GAAkBiH,QAAlB,CAA2B,CAA3B,EAA8B,GAA9B,CAAV,CAAhB;;AAVoB;AAatB;AACEC,UAAAA,eAdoB,GAcF,IAAIJ,UAAJ,CAAe;AACrCV,YAAAA,gBAAgB,EAAhBA,gBADqC;AAErCjH,YAAAA,MAAM,EAAEhC,GAAG,CAACI,IAAJ,CAAS4B,MAFoB;AAEZ;AACzB2B,YAAAA,MAAM,EAAE3D,GAAG,CAACI,IAAJ,CAASuD,MAHoB;AAIrCuF,YAAAA,MAAM,EAAElJ,GAAG,CAACI,IAAJ,CAAS8I,MAJoB;AAKrCtF,YAAAA,KAAK,EAAE5D,GAAG,CAACI,IAAJ,CAASwD,KALqB;AAMrCuF,YAAAA,aAAa,EAAEnJ,GAAG,CAACI,IAAJ,CAAS+I,aANa;AAOrCX,YAAAA,OAAO,EAAExI,GAAG,CAACI,IAAJ,CAASoI,OAPmB;AAQrCY,YAAAA,QAAQ,EAAEpJ,GAAG,CAACI,IAAJ,CAASgJ,QARkB;AASrCxB,YAAAA,SAAS,EAAE5H,GAAG,CAACI,IAAJ,CAASwH,SATiB;AAUrC4B,YAAAA,SAAS,EAAExJ,GAAG,CAACI,IAAJ,CAASoJ,SAViB;AAWrCxB,YAAAA,KAAK,EAAE,IAAIC,IAAJ,EAX8B;AAYrCzB,YAAAA,MAAM,EAAE,WAZ6B,CAYjB;;AAZiB,WAAf,CAdE;AAAA;AAAA,0CA8BhBuD,eAAe,CAACjI,IAAhB,EA9BgB;;AAAA;AA+BtBvB,UAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ,EA/BsB,CAiCtB;;AACMwJ,UAAAA,SAlCgB,GAkCJC,MAAM,CAACnF,IAAP,CAAY9E,GAAG,CAACI,IAAJ,CAASoJ,SAArB,EAAgC,QAAhC,CAlCI,EAoCtB;;AACM3E,UAAAA,WArCgB,GAqCF;AAClBC,YAAAA,IAAI,EAAEoF,OAAO,CAACC,GAAR,CAAYC,UADA;AAElBrF,YAAAA,EAAE,YAAK/E,GAAG,CAACI,IAAJ,CAASwD,KAAd,eAAwBsG,OAAO,CAACC,GAAR,CAAYE,WAAZ,IAA2B,qBAAnD,CAFgB;AAGlBrF,YAAAA,OAAO,0BAAgBiE,gBAAhB,uCAHW;AAIlBqB,YAAAA,IAAI,wCACerB,gBADf,yDAE6BjJ,GAAG,CAACI,IAAJ,CAASuD,MAFtC,sDAG2B3D,GAAG,CAACI,IAAJ,CAASwD,KAHpC,4DAI8B5D,GAAG,CAACI,IAAJ,CAAS+I,aAJvC,wDAK6BnJ,GAAG,CAACI,IAAJ,CAASoI,OALtC,oJAJc;AAclB+B,YAAAA,WAAW,EAAE,CACX;AACEC,cAAAA,QAAQ,uBAAgBvB,gBAAhB,SADV;AAEEwB,cAAAA,OAAO,EAAET,SAFX;AAGEU,cAAAA,WAAW,EAAE;AAHf,aADW;AAdK,WArCE,EA4DtB;;AA5DsB;AAAA,0CA6DhBnG,WAAW,CAACW,QAAZ,CAAqBL,WAArB,CA7DgB;;AAAA;AA8DtBtE,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AAEAP,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnBuC,YAAAA,OAAO,0BAAgB8G,gBAAhB,gDADY;AAEnBA,YAAAA,gBAAgB,EAAhBA,gBAFmB;AAGnBxD,YAAAA,OAAO,EAAE;AAHU,WAArB;AAhEsB;AAAA;;AAAA;AAAA;AAAA;AAuEtBlF,UAAAA,OAAO,CAACG,KAAR,CAAc,UAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnBuC,YAAAA,OAAO,EAAE,iCADU;AAEnBzB,YAAAA,KAAK,EAAE,cAAMyB,OAFM;AAGnBsD,YAAAA,OAAO,EAAE;AAHU,WAArB;;AAxEsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA1B,E,CAiFA;AACA;;AACApG,GAAG,CAAC2D,GAAJ,CAAQ,gCAAR,EAA0C,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAER0J,UAAU,CAACC,cAAX,CAA0B;AAAEpD,YAAAA,MAAM,EAAE;AAAV,WAA1B,CAFQ;;AAAA;AAEhCmE,UAAAA,eAFgC;AAGtC1K,UAAAA,GAAG,CAACL,IAAJ,CAAS;AAAEmI,YAAAA,KAAK,EAAE4C;AAAT,WAAT;AAHsC;AAAA;;AAAA;AAAA;AAAA;AAKtCpK,UAAAA,OAAO,CAACG,KAAR,CAAc,4CAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnBuC,YAAAA,OAAO,EAAE,0CADU;AAEnBzB,YAAAA,KAAK,EAAE,cAAMyB;AAFM,WAArB;;AANsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA1C;AAYA9C,GAAG,UAAH,CAAW,mBAAX,EAAgC,mBAAOW,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEtB0F,UAAAA,EAFsB,GAEjB3F,GAAG,CAACiD,MAAJ,CAAW0C,EAFM;AAAA;AAAA,0CAGtBgE,UAAU,CAACjE,iBAAX,CAA6BC,EAA7B,CAHsB;;AAAA;AAI5B1F,UAAAA,GAAG,CAACL,IAAJ,CAAS;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAAT;AAJ4B;AAAA;;AAAA;AAAA;AAAA;AAM5B5B,UAAAA,OAAO,CAACG,KAAR,CAAc,+BAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE;AAAX,WAArB;;AAP4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAhC,E,CAWA;;AAGA9C,GAAG,CAAC2D,GAAJ,CAAQ,qBAAR,EAA+B,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEP0J,UAAU,CAACC,cAAX,EAFO;;AAAA;AAErB7B,UAAAA,KAFqB;AAG3B9H,UAAAA,GAAG,CAACL,IAAJ,CAAS;AAAEmI,YAAAA,KAAK,EAALA;AAAF,WAAT;AAH2B;AAAA;;AAAA;AAAA;AAAA;AAK3B9H,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAEuC,YAAAA,OAAO,EAAE,8BAAX;AAA2CzB,YAAAA,KAAK;AAAhD,WAArB;;AAL2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA/B,E,CAYA;AACA;;AAEA;;;;;AAIArB,GAAG,CAAC2D,GAAJ,CAAQ,eAAR,EAAyB,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEG0J,UAAU,CAACrG,IAAX,GACrBmF,IADqB,CAChB;AAAET,YAAAA,KAAK,EAAE,CAAC;AAAV,WADgB,EAErBlF,QAFqB,CAEZ,QAFY,EAEF,cAFE,EAGrB8H,IAHqB,EAFH;;AAAA;AAEfC,UAAAA,SAFe;AAOrB;AACAA,UAAAA,SAAS,CAACC,OAAV,CAAkB,UAAAC,GAAG,EAAI;AACvB,gBAAIA,GAAG,CAACnD,SAAJ,IAAiBoD,KAAK,CAACC,OAAN,CAAcF,GAAG,CAACnD,SAAlB,CAArB,EAAmD;AACjDmD,cAAAA,GAAG,CAACnD,SAAJ,GAAgBmD,GAAG,CAACnD,SAAJ,CAAcjF,GAAd,CAAkB,UAAA2F,CAAC;AAAA,uBAAK;AACtC3E,kBAAAA,MAAM,EAAE2E,CAAC,CAAC3E,MAAF,IAAY2E,CAAC,CAACtC,IAAd,IAAsB,YADQ;AAEtC6B,kBAAAA,QAAQ,EAAES,CAAC,CAACT,QAAF,IAAc,CAFc;AAGtCqD,kBAAAA,MAAM,EAAE5C,CAAC,CAAC4C,MAAF,IAAY;AAHkB,iBAAL;AAAA,eAAnB,CAAhB;AAKD;AACF,WARD;AAUAjL,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,IADU;AAEnB0F,YAAAA,KAAK,EAAEN,SAAS,CAAC1H,MAFE;AAGnBiI,YAAAA,IAAI,EAAEP;AAHa,WAArB;AAlBqB;AAAA;;AAAA;AAAA;AAAA;AAwBrBtK,UAAAA,OAAO,CAACG,KAAR,CAAc,0CAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,KADU;AAEnBtD,YAAAA,OAAO,EAAE,+BAFU;AAGnBzB,YAAAA,KAAK,EAAE,cAAIyB;AAHQ,WAArB;;AAzBqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAzB;AAiCA;;;;;AAIA9C,GAAG,CAAC2D,GAAJ,CAAQ,+BAAR,EAAyC,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAE7B+B,UAAAA,MAF6B,GAElBhC,GAAG,CAACiD,MAFc,CAE7BjB,MAF6B;;AAAA,gBAIjC,CAACA,MAAD,IAAWA,MAAM,KAAK,WAAtB,IAAqCA,MAAM,KAAK,MAJf;AAAA;AAAA;AAAA;;AAAA,6CAK5B/B,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1B6F,YAAAA,OAAO,EAAE,KADiB;AAE1BtD,YAAAA,OAAO,EAAE;AAFiB,WAArB,CAL4B;;AAAA;AAWrC5B,UAAAA,OAAO,CAACC,GAAR,wEAAkEwB,MAAlE,GAXqC,CAarC;;AAbqC;AAAA,0CAcV2H,UAAU,CAACrG,IAAX,CAAgB;AAAEtB,YAAAA,MAAM,EAANA;AAAF,WAAhB,EACxByG,IADwB,CACnB;AAAET,YAAAA,KAAK,EAAE,CAAC;AAAV,WADmB,EAExBlF,QAFwB,CAEf;AACRuI,YAAAA,IAAI,EAAE,sBADE;AAER5J,YAAAA,KAAK,EAAE,SAFC;AAEU;AAClByC,YAAAA,MAAM,EAAE,+CAHA;AAIRoH,YAAAA,cAAc,EAAE;AAJR,WAFe,EAQxBpH,MARwB,CAQjB,4CARiB,EASxB0G,IATwB,EAdU;;AAAA;AAc/BW,UAAAA,YAd+B;AAyBrC;AACAA,UAAAA,YAAY,CAACT,OAAb,CAAqB,UAAAC,GAAG,EAAI;AAC1B,gBAAIA,GAAG,CAACnD,SAAJ,IAAiBoD,KAAK,CAACC,OAAN,CAAcF,GAAG,CAACnD,SAAlB,CAArB,EAAmD;AACjDmD,cAAAA,GAAG,CAACnD,SAAJ,GAAgBmD,GAAG,CAACnD,SAAJ,CAAcjF,GAAd,CAAkB,UAAA2F,CAAC,EAAI;AACrC,oBAAMkD,QAAQ,GAAGlD,CAAC,CAACmD,UAAF,IAAgB,EAAjC;AACA,uBAAO;AACP9H,kBAAAA,MAAM,EAAE2E,CAAC,CAACgB,MAAF,IAAYhB,CAAC,CAAC3E,MAAd,IAAwB2E,CAAC,CAACtC,IAA1B,IAAkC,YADnC;AAEL6B,kBAAAA,QAAQ,EAAES,CAAC,CAACT,QAAF,IAAc,CAFnB;AAGLqD,kBAAAA,MAAM,EAAEM,QAAQ,CAACN,MAAT,IAAmB,CAHtB;AAILQ,kBAAAA,MAAM,EAAEF,QAAQ,CAACtF,KAAT,IAAkB,EAJrB;AAKLmD,kBAAAA,SAAS,EAAEmC,QAAQ,CAACjF,QAAT,IAAqB;AAL3B,iBAAP;AAOD,eATe,CAAhB;AAUD;AACF,WAbD;AA1BqC,6CAyC9BtG,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1B6F,YAAAA,OAAO,EAAE,IADiB;AAE1B0F,YAAAA,KAAK,EAAEI,YAAY,CAACpI,MAFM;AAG1BiI,YAAAA,IAAI,EAAEG;AAHoB,WAArB,CAzC8B;;AAAA;AAAA;AAAA;AA+CrChL,UAAAA,OAAO,CAACG,KAAR,CAAc,yCAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,KADU;AAEnBtD,YAAAA,OAAO,EAAE,wCAFU;AAGnBzB,YAAAA,KAAK,EAAE,cAAIyB;AAHQ,WAArB;;AAhDqC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAzC;AAwDA;;;;;AAIA9C,GAAG,CAAC2D,GAAJ,CAAQ,6BAAR,EAAuC,mBAAOhD,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAE3B0L,UAAAA,YAF2B,GAEV3L,GAAG,CAACiD,MAFM,CAE3B0I,YAF2B;;AAAA,gBAI/B,CAACA,YAAD,IAAiBA,YAAY,KAAK,WAJH;AAAA;AAAA;AAAA;;AAAA,6CAK1B1L,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1B6F,YAAAA,OAAO,EAAE,KADiB;AAE1BtD,YAAAA,OAAO,EAAE;AAFiB,WAArB,CAL0B;;AAAA;AAAA;AAAA,0CAWVwH,UAAU,CAACtH,QAAX,CAAoBsJ,YAApB,EACtB7I,QADsB,CACb;AACRuI,YAAAA,IAAI,EAAE,sBADE;AAER5J,YAAAA,KAAK,EAAE,SAFC;AAGRyC,YAAAA,MAAM,EAAE,+CAHA;AAIRoH,YAAAA,cAAc,EAAE;AAJR,WADa,EAOtBV,IAPsB,EAXU;;AAAA;AAW7BgB,UAAAA,UAX6B;;AAAA,cAoB9BA,UApB8B;AAAA;AAAA;AAAA;;AAAA,6CAqB1B3L,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1B6F,YAAAA,OAAO,EAAE,KADiB;AAE1BtD,YAAAA,OAAO,EAAE;AAFiB,WAArB,CArB0B;;AAAA;AA2BnC;AACA,cAAIyJ,UAAU,CAAChE,SAAX,IAAwBoD,KAAK,CAACC,OAAN,CAAcW,UAAU,CAAChE,SAAzB,CAA5B,EAAiE;AAC/DgE,YAAAA,UAAU,CAAChE,SAAX,GAAuBgE,UAAU,CAAChE,SAAX,CAAqBjF,GAArB,CAAyB,UAAA2F,CAAC,EAAI;AACnD,kBAAMkD,QAAQ,GAAGlD,CAAC,CAACmD,UAAF,IAAgB,EAAjC;AACA,qBAAO;AACP9H,gBAAAA,MAAM,EAAE2E,CAAC,CAACgB,MAAF,IAAYhB,CAAC,CAAC3E,MAAd,IAAwB2E,CAAC,CAACtC,IAA1B,IAAkC,YADnC;AAEL6B,gBAAAA,QAAQ,EAAES,CAAC,CAACT,QAAF,IAAc,CAFnB;AAGLqD,gBAAAA,MAAM,EAAEM,QAAQ,CAACN,MAAT,IAAmB,CAHtB;AAILQ,gBAAAA,MAAM,EAAEF,QAAQ,CAACtF,KAAT,IAAkB,EAJrB;AAKLmD,gBAAAA,SAAS,EAAEmC,QAAQ,CAACjF,QAAT,IAAqB;AAL3B,eAAP;AAOD,aATsB,CAAvB;AAUD;;AAEDtG,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,IADU;AAEnB2F,YAAAA,IAAI,EAAEQ;AAFa,WAArB;AAzCmC;AAAA;;AAAA;AAAA;AAAA;AA8CnCrL,UAAAA,OAAO,CAACG,KAAR,CAAc,8BAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,KADU;AAEnBtD,YAAAA,OAAO,EAAE,gCAFU;AAGnBzB,YAAAA,KAAK,EAAE,cAAIyB;AAHQ,WAArB;;AA/CmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAvC;AAuDA;;;;;AAIA9C,GAAG,CAACwM,KAAJ,CAAU,oCAAV,EAAgD,mBAAO7L,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEpC0L,UAAAA,YAFoC,GAEnB3L,GAAG,CAACiD,MAFe,CAEpC0I,YAFoC;AAGpCnF,UAAAA,MAHoC,GAGzBxG,GAAG,CAACI,IAHqB,CAGpCoG,MAHoC;AAKtCsF,UAAAA,iBALsC,GAKlB,CACxB,WADwB,EAExB,YAFwB,EAGxB,UAHwB,EAIxB,YAJwB,EAKxB,WALwB,CALkB;;AAAA,gBAaxC,CAACtF,MAAD,IAAW,CAACsF,iBAAiB,CAACtJ,QAAlB,CAA2BgE,MAAM,CAACuF,WAAP,EAA3B,CAb4B;AAAA;AAAA;AAAA;;AAAA,6CAcnC9L,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1B6F,YAAAA,OAAO,EAAE,KADiB;AAE1BtD,YAAAA,OAAO,EAAE,kBAFiB;AAG1B2J,YAAAA,iBAAiB,EAAjBA;AAH0B,WAArB,CAdmC;;AAAA;AAAA;AAAA,0CAqBnBnC,UAAU,CAACnC,iBAAX,CACvBmE,YADuB,EAEvB;AAAEnF,YAAAA,MAAM,EAAEA,MAAM,CAACuF,WAAP,EAAV;AAAgCrC,YAAAA,SAAS,EAAE,IAAIzB,IAAJ;AAA3C,WAFuB,EAGvB;AAAE,mBAAK,IAAP;AAAa+D,YAAAA,aAAa,EAAE;AAA5B,WAHuB,CArBmB;;AAAA;AAqBtCJ,UAAAA,UArBsC;;AAAA,cA2BvCA,UA3BuC;AAAA;AAAA;AAAA;;AAAA,6CA4BnC3L,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1B6F,YAAAA,OAAO,EAAE,KADiB;AAE1BtD,YAAAA,OAAO,EAAE;AAFiB,WAArB,CA5BmC;;AAAA;AAkC5ClC,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,IADU;AAEnBtD,YAAAA,OAAO,EAAE,kCAFU;AAGnBiJ,YAAAA,IAAI,EAAEQ;AAHa,WAArB;AAlC4C;AAAA;;AAAA;AAAA;AAAA;AAwC5CrL,UAAAA,OAAO,CAACG,KAAR,CAAc,6BAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,KADU;AAEnBtD,YAAAA,OAAO,EAAE,+BAFU;AAGnBzB,YAAAA,KAAK,EAAE,cAAIyB;AAHQ,WAArB;;AAzC4C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAhD;AAiDA;;;;;AAIA9C,GAAG,UAAH,CAAW,6BAAX,EAA0C,mBAAOW,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAE9B0L,UAAAA,YAF8B,GAEb3L,GAAG,CAACiD,MAFS,CAE9B0I,YAF8B;AAAA;AAAA,0CAIbhC,UAAU,CAACjE,iBAAX,CAA6BiG,YAA7B,CAJa;;AAAA;AAIhCC,UAAAA,UAJgC;;AAAA,cAMjCA,UANiC;AAAA;AAAA;AAAA;;AAAA,6CAO7B3L,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAC1B6F,YAAAA,OAAO,EAAE,KADiB;AAE1BtD,YAAAA,OAAO,EAAE;AAFiB,WAArB,CAP6B;;AAAA;AAatClC,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,IADU;AAEnBtD,YAAAA,OAAO,EAAE;AAFU,WAArB;AAbsC;AAAA;;AAAA;AAAA;AAAA;AAkBtC5B,UAAAA,OAAO,CAACG,KAAR,CAAc,+BAAd;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AACnB6F,YAAAA,OAAO,EAAE,KADU;AAEnBtD,YAAAA,OAAO,EAAE,iCAFU;AAGnBzB,YAAAA,KAAK,EAAE,cAAIyB;AAHQ,WAArB;;AAnBsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA1C;AA2BA9C,GAAG,CAACkI,GAAJ,CAAQ,mBAAR,EAA6B,mBAAOvH,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEjB0F,UAAAA,EAFiB,GAEV3F,GAAG,CAACiD,MAFM,CAEjB0C,EAFiB;AAGjBa,UAAAA,MAHiB,GAGNxG,GAAG,CAACI,IAHE,CAGjBoG,MAHiB;AAAA;AAAA,0CAKAmD,UAAU,CAACnC,iBAAX,CACvB7B,EADuB,EAEvB;AAAEa,YAAAA,MAAM,EAANA;AAAF,WAFuB,EAGvB;AAAE,mBAAK;AAAP,WAHuB,CALA;;AAAA;AAKnBoF,UAAAA,UALmB;;AAAA,cAWpBA,UAXoB;AAAA;AAAA;AAAA;;AAAA,6CAYhB3L,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAE6F,YAAAA,OAAO,EAAE,KAAX;AAAkBtD,YAAAA,OAAO,EAAE;AAA3B,WAArB,CAZgB;;AAAA;AAezBlC,UAAAA,GAAG,CAACL,IAAJ,CAAS;AAAE6F,YAAAA,OAAO,EAAE,IAAX;AAAiB2F,YAAAA,IAAI,EAAEQ;AAAvB,WAAT;AAfyB;AAAA;;AAAA;AAAA;AAAA;AAiBzBrL,UAAAA,OAAO,CAACG,KAAR;AACAT,UAAAA,GAAG,CAACiC,MAAJ,CAAW,GAAX,EAAgBtC,IAAhB,CAAqB;AAAE6F,YAAAA,OAAO,EAAE,KAAX;AAAkBtD,YAAAA,OAAO,EAAE;AAA3B,WAArB;;AAlByB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA7B,E,CAyBA;AAEA;;AACA9C,GAAG,CAAC4M,MAAJ,CAAW3M,IAAX,EAAiB,YAAM;AACnBiB,EAAAA,OAAO,CAACC,GAAR,8CAAkDlB,IAAlD;AACH,CAFD","sourcesContent":["const express = require('express');\r\nconst mongoose = require('mongoose');\r\nconst cors = require('cors');\r\nconst app = express();\r\nconst PORT = 3000;\r\n\r\nconst PDFDocument = require('pdfkit');\r\n\r\n\r\n// Middleware - IMPORTANTE: el orden es crucial\r\n// CORS primero\r\napp.use(cors({\r\n  origin: ['http://localhost:4200', 'http://localhost:3200'], // acepta ambos\r\n  methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],\r\n  allowedHeaders: ['Content-Type', 'Authorization']\r\n}));\r\napp.use(express.json({ limit: '60mb' })); // aceptar JSON grandes\r\napp.use(express.urlencoded({ extended: true, limit: '50mb' })); // aceptar formularios grandes\r\napp.use(express.json({ limit: '80mb' })); // muy importante para im√°genes en base64\r\n\r\n\r\n// Middleware personalizado para convertir text/plain a JSON cuando es necesario\r\napp.use((req, res, next) => {\r\n    if (req.headers['content-type'] === 'text/plain' && req.body && typeof req.body === 'string') {\r\n        try {\r\n            req.body = JSON.parse(req.body);\r\n            console.log('Converted text/plain to JSON:', req.body);\r\n        } catch (e) {\r\n            console.error('Failed to parse text/plain as JSON:', e);\r\n        }\r\n    }\r\n    next();\r\n});\r\n\r\n// MongoDB Connection\r\nconst dbURI = 'mongodb://localhost:27017/mydatabase';\r\nmongoose.connect(dbURI)\r\n    .then(() => console.log('MongoDB connected'))\r\n    .catch(err => console.error('MongoDB connection error:', err));\r\n\r\n// User Schema\r\nconst userSchema = new mongoose.Schema({\r\n    username: { type: String, required: true, unique: true },\r\n    password: { type: String, required: true },\r\n    role: { type: String, default: 'admin' }\r\n});\r\nconst User = mongoose.model('User', userSchema);\r\n\r\n// Default Admin User\r\nasync function createAdminUser() {\r\n    const admin = await User.findOne({ username: 'admin' });\r\n    if (!admin) {\r\n        const newAdmin = new User({ username: 'admin', password: 'admin123', role: 'admin' });\r\n        await newAdmin.save();\r\n        console.log('Admin user created');\r\n    } else {\r\n        console.log('Admin user already exists');\r\n    }\r\n}\r\ncreateAdminUser();\r\n\r\n// üìå Agregar producto a favoritos\r\napp.post('/favorites', async (req, res) => {\r\n  try {\r\n    const { userId, productId } = req.body;\r\n\r\n    if (!userId || !productId) {\r\n      return res.status(400).json({ message: \"Faltan userId o productId\" });\r\n    }\r\n\r\n    const user = await UserCliente.findById(userId); // üëà cambio a UserCliente\r\n    if (!user) return res.status(404).json({ message: \"Usuario no encontrado\" });\r\n\r\n    if (!user.favorites.includes(productId)) {\r\n      user.favorites.push(productId);\r\n      user.favorites = [...new Set(user.favorites.map(f => f.toString()))];\r\n      await user.save();\r\n    }\r\n\r\n    const updatedUser = await UserCliente.findById(userId).populate('favorites'); // üëà cambio\r\n    res.json({\r\n      message: \"Producto agregado a favoritos\",\r\n      favorites: updatedUser.favorites\r\n    });\r\n  } catch (err) {\r\n    console.error(\"‚ùå Error en POST /favorites:\", err);\r\n    res.status(500).json({ message: \"Error al agregar a favoritos\", error: err.message });\r\n  }\r\n});\r\n\r\n// üìå Obtener favoritos de un cliente\r\napp.get('/favorites/:userId', async (req, res) => {\r\n  try {\r\n    const { userId } = req.params;\r\n\r\n    const user = await UserCliente.findById(userId).populate('favorites'); // üëà cambio\r\n    if (!user) return res.status(404).json({ message: \"Usuario no encontrado\" });\r\n\r\n    res.json({\r\n      message: \"Favoritos obtenidos correctamente\",\r\n      favorites: user.favorites\r\n    });\r\n  } catch (err) {\r\n    console.error(\"‚ùå Error en GET /favorites/:userId:\", err);\r\n    res.status(500).json({ message: \"Error al obtener favoritos\", error: err.message });\r\n  }\r\n});\r\n\r\n// üìå Eliminar producto de favoritos\r\napp.delete('/favorites/:userId/:productId', async (req, res) => {\r\n  try {\r\n    const { userId, productId } = req.params;\r\n\r\n    const user = await UserCliente.findById(userId); // üëà cambio\r\n    if (!user) return res.status(404).json({ message: \"Usuario no encontrado\" });\r\n\r\n    const before = user.favorites.length;\r\n    user.favorites = user.favorites.filter(fav => fav.toString() !== productId);\r\n\r\n    if (before === user.favorites.length) {\r\n      return res.status(404).json({ message: \"Producto no estaba en favoritos\" });\r\n    }\r\n\r\n    await user.save();\r\n    const updatedUser = await UserCliente.findById(userId).populate('favorites'); // üëà cambio\r\n\r\n    res.json({\r\n      message: \"Producto eliminado de favoritos\",\r\n      favorites: updatedUser.favorites\r\n    });\r\n  } catch (err) {\r\n    console.error(\"‚ùå Error en DELETE /favorites/:userId/:productId:\", err);\r\n    res.status(500).json({ message: \"Error al eliminar de favoritos\", error: err.message });\r\n  }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Rutas de Usuario\r\napp.get('/users', async (req, res) => {\r\n    try {\r\n        const users = await User.find();\r\n        res.json(users);\r\n    } catch (err) {\r\n        res.status(500).json({ message: 'Error al obtener usuarios', error: err });\r\n    }\r\n});\r\n\r\napp.post('/login', async (req, res) => {\r\n    const { username, password } = req.body;\r\n    const user = await User.findOne({ username, password });\r\n    if (user) {\r\n        res.json({ message: 'Login successful', user });\r\n    } else {\r\n        res.status(401).json({ message: 'Invalid credentials' });\r\n    }\r\n});\r\n\r\n// Registro de Cliente\r\napp.post('/register', async (req, res) => {\r\n    const { username, password } = req.body;\r\n    try {\r\n        const existingUser = await User.findOne({ username });\r\n        if (existingUser) {\r\n            return res.status(400).json({ message: 'El usuario ya existe' });\r\n        }\r\n\r\n        const newUser = new User({ username, password, role: 'cliente' });\r\n        await newUser.save();\r\n        res.status(201).json({ message: 'Cliente registrado correctamente', user: newUser });\r\n    } catch (err) {\r\n        res.status(500).json({ message: 'Error al registrar cliente', error: err });\r\n    }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//===========================USER CLIENTE =================///\r\n\r\n\r\nconst userClienteSchema = new mongoose.Schema({\r\n  password: { type: String, required: true },               \r\n  nombre: { type: String, required: true },                 \r\n  email: { type: String, required: true, unique: true },    \r\n  telefono: { type: String },                               \r\n  direccion: { type: String },       \r\n    favorites: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Product' }] // ‚≠ê nuevo campo\r\n                        \r\n});\r\n\r\nconst UserCliente = mongoose.model('UserCliente', userClienteSchema);\r\n\r\napp.get('/clientes', async (req, res) => {\r\n    try {\r\n        const clientes = await UserCliente.find().select('-password'); // No devolver passwords\r\n        res.json(clientes);\r\n    } catch (err) {\r\n        res.status(500).json({ message: 'Error al obtener clientes', error: err.message });\r\n    }\r\n});\r\n\r\n\r\n// Registro de nuevo cliente\r\napp.post('/clientes/register', async (req, res) => {\r\n    try {\r\n        console.log('Datos recibidos para registro:', req.body);\r\n        \r\n        const { password, nombre, email, telefono, direccion } = req.body;\r\n\r\n        // Validaciones\r\n        if (!password || !nombre || !email) {\r\n            return res.status(400).json({ \r\n                message: 'Password, nombre y email son obligatorios',\r\n                receivedData: req.body\r\n            });\r\n        }\r\n\r\n        // Verificar si el email ya existe\r\n        const existingCliente = await UserCliente.findOne({ email });\r\n        if (existingCliente) {\r\n            return res.status(400).json({ message: 'El email ya est√° registrado' });\r\n        }\r\n        const nodemailer = require('nodemailer');\r\n\r\n// Configura tu transporte (puede ser Gmail)\r\nconst transporter = nodemailer.createTransport({\r\n  service: 'gmail',\r\n  auth: {\r\n    user: 'monica.romeroz.2003@gmail.com', // <-- tu correo Gmail\r\n    pass: 'txapatbhiebaxbbg'   // <-- tu contrase√±a de app (¬°no tu clave real!)\r\n  }\r\n});\r\n\r\n\r\n        // Crear nuevo cliente\r\n        const newCliente = new UserCliente({ \r\n            password, \r\n            nombre, \r\n            email, \r\n            telefono: telefono || '', \r\n            direccion: direccion || '' \r\n        });\r\n\r\n        await newCliente.save();\r\n\r\n// ENVIAR CORREO AL CLIENTE\r\nconst mailOptions = {\r\n  from: 'monica.romeroz.2003@gmail.com',\r\n  to: email,\r\n  subject: 'Registro en la Web de DINSAC',\r\n  text: `¬°Hola ${nombre}! \r\n  ¬°Gracias por registrarte en la plataforma de DINSAC!\r\n\r\nAhora puedes explorar nuestros productos y realizar tus compras cuando gustes.  \r\nSi tienes dudas, escr√≠benos a soporte@dinsac.com\r\n\r\n¬°Que tengas un excelente d√≠a!\r\n\r\nAtentamente,  \r\nEl equipo de DINSAC..`\r\n};\r\n\r\ntransporter.sendMail(mailOptions, (error, info) => {\r\n  if (error) {\r\n    console.error('Error al enviar correo:', error);\r\n  } else {\r\n    console.log('Correo enviado: ' + info.response);\r\n  }\r\n});\r\n\r\n        \r\n        // Devolver cliente sin password\r\n        const clienteResponse = {\r\n            _id: newCliente._id,\r\n            nombre: newCliente.nombre,\r\n            email: newCliente.email,\r\n            telefono: newCliente.telefono,\r\n            direccion: newCliente.direccion\r\n        };\r\n\r\n        res.status(201).json({ \r\n            message: 'Cliente registrado correctamente', \r\n            cliente: clienteResponse \r\n        });\r\n    } catch (err) {\r\n        console.error('Error registrando cliente:', err);\r\n        if (err.code === 11000) {\r\n            // Error de duplicado de MongoDB\r\n            res.status(400).json({ message: 'El email ya est√° registrado' });\r\n        } else {\r\n            res.status(500).json({ message: 'Error al registrar cliente', error: err.message });\r\n        }\r\n    }\r\n});\r\n\r\n// Login de cliente\r\napp.post('/clientes/login', async (req, res) => {\r\n    try {\r\n        console.log('Intento de login:', req.body);\r\n        \r\n        const { email, password } = req.body;\r\n\r\n        // Validaciones\r\n        if (!email || !password) {\r\n            return res.status(400).json({ message: 'Email y password son obligatorios' });\r\n        }\r\n\r\n        // Buscar cliente por email y password\r\n        const cliente = await UserCliente.findOne({ email, password });\r\n        \r\n        if (cliente) {\r\n            // Login exitoso - devolver datos sin password\r\n            const clienteResponse = {\r\n                _id: cliente._id,\r\n                nombre: cliente.nombre,\r\n                email: cliente.email,\r\n                telefono: cliente.telefono,\r\n                direccion: cliente.direccion\r\n            };\r\n            \r\n            res.json({ \r\n                message: 'Login exitoso', \r\n                cliente: clienteResponse,\r\n                success: true\r\n            });\r\n        } else {\r\n            res.status(401).json({ \r\n                message: 'Credenciales inv√°lidas',\r\n                success: false\r\n            });\r\n        }\r\n    } catch (err) {\r\n        console.error('Error en login:', err);\r\n        res.status(500).json({ message: 'Error en el servidor', error: err.message });\r\n    }\r\n});\r\n\r\n\r\n// Eliminar cliente\r\napp.delete('/clientes/:id', async (req, res) => {\r\n    try {\r\n        const deletedCliente = await UserCliente.findByIdAndDelete(req.params.id);\r\n        \r\n        if (!deletedCliente) {\r\n            return res.status(404).json({ message: 'Cliente no encontrado' });\r\n        }\r\n\r\n        res.json({ \r\n            message: 'Cliente eliminado correctamente',\r\n            cliente: {\r\n                _id: deletedCliente._id,\r\n                nombre: deletedCliente.nombre,\r\n                email: deletedCliente.email\r\n            }\r\n        });\r\n    } catch (err) {\r\n        console.error('Error eliminando cliente:', err);\r\n        res.status(500).json({ message: 'Error eliminando cliente', error: err.message });\r\n    }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// =================== PRODUCTOS ===================\r\nconst nodemailer = require('nodemailer');\r\n\r\n// =================== CONFIGURACI√ìN DE CORREO ===================\r\nconst transporter = nodemailer.createTransport({\r\n  service: 'gmail',\r\n  auth: {\r\n    user: 'monica.romeroz.2003@gmail.com',\r\n    pass: 'txapatbhiebaxbbg'\r\n  }\r\n});\r\n\r\n// =================== PRODUCTOS ===================\r\n\r\n// Esquema actualizado del producto\r\nconst productSchema = new mongoose.Schema({\r\n  codigo: { type: Number, required: true },\r\n  name: { type: String, required: true },\r\n  description: { type: String, required: true },\r\n  image: { type: String, required: true },\r\n  image1: { type: String, required: false },\r\n  image2: { type: String, required: false },\r\n  image3: { type: String, required: false },\r\n  stock: { type: Number, required: true },\r\n  category: { type: String, required: true },\r\n  estado: { \r\n    type: String, \r\n    enum: ['Normal', 'Oferta'], // <-- solo acepta estos dos valores\r\n    required: true \r\n  },\r\n  videoURL: { type: String, required: false },\r\n  featuresText: { type: String, required: false },\r\n  tagsText: { type: String, required: false },\r\n  destacado: { type: Boolean, default: false }\r\n});\r\n\r\nconst Product = mongoose.model('Product', productSchema);\r\n\r\n// =================== RUTAS ===================\r\n\r\n// Obtener todos los productos (con filtros opcionales)\r\napp.get('/products', async (req, res) => {\r\n  try {\r\n    const { category, estado } = req.query;\r\n\r\n    const query = {};\r\n    if (category) query.category = category;\r\n    if (estado) query.estado = estado; // <-- permite filtrar por Normal u Oferta\r\n\r\n    const products = await Product.find(query);\r\n    res.json(products);\r\n  } catch (err) {\r\n    res.status(500).json({ message: 'Error fetching products', error: err });\r\n  }\r\n});\r\n\r\n// Obtener producto por ID\r\napp.get('/products/:id', async (req, res) => {\r\n  try {\r\n    const product = await Product.findById(req.params.id);\r\n    if (!product) return res.status(404).json({ message: 'Product not found' });\r\n    res.json(product);\r\n  } catch (err) {\r\n    res.status(500).json({ message: 'Error fetching product', error: err });\r\n  }\r\n});\r\n\r\n// Crear un nuevo producto\r\napp.post('/products', async (req, res) => {\r\n  try {\r\n    console.log('üì• POST /products recibido');\r\n    console.log('Body:', req.body);\r\n\r\n    if (!req.body || Object.keys(req.body).length === 0) {\r\n      return res.status(400).json({\r\n        message: 'Error: Request body vac√≠o o indefinido',\r\n        receivedHeaders: req.headers\r\n      });\r\n    }\r\n\r\n    const {\r\n      codigo,\r\n      name,\r\n      description,\r\n      image,\r\n      image1,\r\n      image2,\r\n      image3,\r\n      stock,\r\n      category,\r\n      estado,\r\n      videoURL,\r\n      featuresText,\r\n      tagsText,\r\n      destacado\r\n    } = req.body;\r\n\r\n    // Validaciones m√≠nimas\r\n    if (!codigo || !name || !description || !image || !stock || !category || !estado) {\r\n      return res.status(400).json({\r\n        message: 'Faltan campos obligatorios',\r\n        receivedData: req.body\r\n      });\r\n    }\r\n\r\n    const newProduct = new Product({\r\n      codigo,\r\n      name,\r\n      description,\r\n      image,\r\n      image1,\r\n      image2,\r\n      image3,\r\n      stock,\r\n      category,\r\n      estado,\r\n      videoURL,\r\n      featuresText,\r\n      tagsText,\r\n      destacado\r\n    });\r\n\r\n    await newProduct.save();\r\n    console.log('‚úÖ Producto guardado correctamente:', newProduct);\r\n    res.status(201).json(newProduct);\r\n  } catch (err) {\r\n    console.error('‚ùå Error al crear producto:', err);\r\n    res.status(400).json({\r\n      message: 'Error creando producto',\r\n      error: err.message || err,\r\n      stack: err.stack\r\n    });\r\n  }\r\n});\r\n\r\n// Actualizar un producto por ID\r\napp.put('/products/:id', async (req, res) => {\r\n  try {\r\n    const updatedProduct = await Product.findByIdAndUpdate(req.params.id, req.body, { new: true });\r\n    if (!updatedProduct) return res.status(404).json({ message: 'Product not found' });\r\n    res.json(updatedProduct);\r\n  } catch (err) {\r\n    res.status(400).json({ message: 'Error updating product', error: err });\r\n  }\r\n});\r\n\r\n// Eliminar un producto por ID\r\napp.delete('/products/:id', async (req, res) => {\r\n  try {\r\n    const deletedProduct = await Product.findByIdAndDelete(req.params.id);\r\n    if (!deletedProduct) return res.status(404).json({ message: 'Product not found' });\r\n    res.json({ message: 'Product deleted successfully' });\r\n  } catch (err) {\r\n    res.status(500).json({ message: 'Error deleting product', error: err });\r\n  }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// =================== orden===================\r\n\r\n\r\nconst ordenSchema = new mongoose.Schema({\r\n  nombre: String,\r\n  email: String,\r\n  productos: [\r\n    {\r\n      name: String,\r\n      cantidad: Number,\r\n      price: Number\r\n    }\r\n  ],\r\n  total: Number,\r\n  fecha: {\r\n    type: Date,\r\n    default: Date.now\r\n  }\r\n});\r\n\r\nconst Orden = mongoose.model('Orden', ordenSchema);\r\n\r\n\r\napp.post('/ordenes', async (req, res) => {\r\n  try {\r\n    const { nombre, email, productos, total } = req.body;\r\n\r\n    // Guardar la orden en MongoDB\r\n    const nuevaOrden = new Orden({ nombre, email, productos, total });\r\n    await nuevaOrden.save();\r\n\r\n    // Armar el mensaje del correo\r\n    const resumen = productos\r\n      .map(p => `- ${p.name} (x${p.cantidad}) - S/ ${p.price * p.cantidad}`)\r\n      .join('\\n');\r\n\r\n    const mensaje = `Hola ${nombre},\\n\\nGracias por tu compra en DINSAC.\\n\\nResumen:\\n${resumen}\\n\\nTotal: S/ ${total}\\n\\nSaludos,\\nEquipo DINSAC`;\r\n\r\n    // Enviar correo\r\n    await transporter.sendMail({\r\n      from: 'tucorreo@gmail.com', // reemplaza por tu correo real\r\n      to: email,\r\n      subject: 'üßæ Confirmaci√≥n de tu compra en DINSAC, ¬°Gracias por tu compra en DINSAC! üéâ',\r\n      text: mensaje\r\n    });\r\n\r\n    res.status(200).json({ message: 'Orden registrada y correo enviado.' });\r\n  } catch (error) {\r\n    console.error('Error al registrar orden:', error);\r\n    res.status(500).json({ message: 'Error al guardar orden o enviar correo.' });\r\n  }\r\n});\r\n\r\napp.get('/ordenes', async (req, res) => {\r\n  try {\r\n    const ordenes = await Orden.find().sort({ fecha: -1 }); // m√°s recientes arriba\r\n    res.json(ordenes);\r\n  } catch (error) {\r\n    res.status(500).json({ message: 'Error al obtener √≥rdenes' });\r\n  }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n// =================== para IA  ===================\r\n// ========== ESQUEMA DE INTERACCIONES ==========\r\nconst interaccionSchema = new mongoose.Schema({\r\n  usuario: String,\r\n  mensaje: String,\r\n  fecha: Date\r\n});\r\n\r\nconst Interaccion = mongoose.model('Interaccion', interaccionSchema);\r\n\r\n// ========== RUTA PARA GUARDAR ==========\r\napp.post('/interacciones', async (req, res) => {\r\n  try {\r\n    const nueva = new Interaccion(req.body);\r\n    await nueva.save();\r\n    res.status(201).json({ message: '‚úÖ Interacci√≥n guardada' });\r\n  } catch (err) {\r\n    res.status(500).json({ error: 'Error al guardar la interacci√≥n' });\r\n  }\r\n});\r\n\r\n// ========== RUTA PARA OBTENER ==========\r\napp.get('/interacciones', async (req, res) => {\r\n  try {\r\n    const interacciones = await Interaccion.find().sort({ fecha: -1 });\r\n    res.json(interacciones);\r\n  } catch (err) {\r\n    res.status(500).json({ error: 'Error al obtener interacciones' });\r\n  }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n// =================== COTIZACION  ===================\r\n\r\nconst cotizacionSchema = new mongoose.Schema({\r\n  numeroCotizacion: { type: String, required: true, unique: true },\r\nuserId: { type: mongoose.Schema.Types.ObjectId, ref: 'UserCliente', required: true },\r\n  nombre: String,\r\n  dniRuc: String,\r\n  email: String,\r\n  telefonoMovil: String,\r\n  mensaje: String,\r\n  contacto: String,\r\n  productos: [\r\n    {\r\n      categoria: String,\r\n      equipo: String,\r\n      cantidad: Number,\r\n      precioUnitario: Number\r\n    }\r\n  ],\r\n  pdfBase64: String,\r\n  fecha: { type: Date, default: Date.now },\r\n  estado: { type: String, default: 'pendiente' }, // üü¢ <--- AGREGA ESTO\r\n  createdAt: { type: Date, default: Date.now },\r\n  updatedAt: { type: Date, default: Date.now }\r\n});\r\n\r\n\r\n\r\nconst Cotizacion = mongoose.model('Cotizacion', cotizacionSchema);\r\n\r\n\r\n\r\n// ===================  GUARDAR COTIZACION  ===================\r\n\r\n// ‚úÖ Endpoint corregido para guardar cotizaci√≥n y enviar correo\r\napp.post('/cotizaciones', async (req, res) => {\r\n  try {\r\n    console.log('üìß Procesando cotizaci√≥n...');\r\n\r\n    // üëâ Usar el n√∫mero que viene del frontend o generar uno nuevo\r\n    let numeroCotizacion = req.body.numeroCotizacion;\r\n    \r\n    if (!numeroCotizacion) {\r\n      const total = await Cotizacion.countDocuments();\r\n      const numero = total + 1;\r\n      numeroCotizacion = `COT-${numero.toString().padStart(8, '0')}`;\r\n    }\r\n\r\n    // üëâ Crear nueva cotizaci√≥n\r\nconst nuevaCotizacion = new Cotizacion({\r\n  numeroCotizacion,\r\n  userId: req.body.userId, // üëà vincula con el cliente logueado\r\n  nombre: req.body.nombre,\r\n  dniRuc: req.body.dniRuc,\r\n  email: req.body.email,\r\n  telefonoMovil: req.body.telefonoMovil,\r\n  mensaje: req.body.mensaje,\r\n  contacto: req.body.contacto,\r\n  productos: req.body.productos,\r\n  pdfBase64: req.body.pdfBase64,\r\n  fecha: new Date(),\r\n  estado: 'pendiente' // üîπ por defecto al crear\r\n});\r\n\r\n\r\n    await nuevaCotizacion.save();\r\n    console.log('‚úÖ Cotizaci√≥n guardada en BD');\r\n\r\n    // üëâ Convertir el PDF base64 a buffer\r\n    const pdfBuffer = Buffer.from(req.body.pdfBase64, 'base64');\r\n\r\n    // üëâ Configurar correo\r\n    const mailOptions = {\r\n      from: process.env.EMAIL_USER,\r\n      to: `${req.body.email}, ${process.env.EMAIL_OWNER || 'admin@tuempresa.com'}`,\r\n      subject: `Cotizaci√≥n ${numeroCotizacion} - Distribuidora Industrial S.A.C.`,\r\n      html: `\r\n        <h3>Cotizaci√≥n ${numeroCotizacion}</h3>\r\n        <p><strong>Cliente:</strong> ${req.body.nombre}</p>\r\n        <p><strong>Email:</strong> ${req.body.email}</p>\r\n        <p><strong>Tel√©fono:</strong> ${req.body.telefonoMovil}</p>\r\n        <p><strong>Mensaje:</strong> ${req.body.mensaje}</p>\r\n        <br>\r\n        <p>Adjuntamos la cotizaci√≥n en formato PDF.</p>\r\n        <p><em>Distribuidora Industrial S.A.C.</em></p>\r\n      `,\r\n      attachments: [\r\n        {\r\n          filename: `Cotizacion_${numeroCotizacion}.pdf`,\r\n          content: pdfBuffer,\r\n          contentType: 'application/pdf'\r\n        }\r\n      ]\r\n    };\r\n\r\n    // üëâ Enviar correo\r\n    await transporter.sendMail(mailOptions);\r\n    console.log('‚úÖ Correo enviado exitosamente');\r\n\r\n    res.status(201).json({ \r\n      message: `Cotizaci√≥n ${numeroCotizacion} guardada y enviada por correo exitosamente`,\r\n      numeroCotizacion,\r\n      success: true\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Error:', error);\r\n    res.status(500).json({\r\n      message: 'Error al procesar la cotizaci√≥n',\r\n      error: error.message,\r\n      success: false\r\n    });\r\n  }\r\n});\r\n\r\n\r\n// üîπ Contar cotizaciones pendientes\r\n// üîπ Contar cotizaciones pendientes (usando Mongoose)\r\napp.get('/cotizaciones/pendientes/total', async (req, res) => {\r\n  try {\r\n    const totalPendientes = await Cotizacion.countDocuments({ estado: 'pendiente' });\r\n    res.json({ total: totalPendientes });\r\n  } catch (error) {\r\n    console.error('‚ùå Error al contar cotizaciones pendientes:', error);\r\n    res.status(500).json({\r\n      message: 'Error al obtener cotizaciones pendientes',\r\n      error: error.message\r\n    });\r\n  }\r\n});\r\napp.delete('/cotizaciones/:id', async (req, res) => {\r\n  try {\r\n    const id = req.params.id;\r\n    await Cotizacion.findByIdAndDelete(id);\r\n    res.json({ message: 'Cotizaci√≥n eliminada correctamente' });\r\n  } catch (error) {\r\n    console.error('Error al eliminar cotizaci√≥n:', error);\r\n    res.status(500).json({ message: 'Error al eliminar cotizaci√≥n' });\r\n  }\r\n});\r\n\r\n// ===================  contar COTIZACION  ===================\r\n\r\n\r\napp.get('/cotizaciones/total', async (req, res) => {\r\n  try {\r\n    const total = await Cotizacion.countDocuments();\r\n    res.json({ total });\r\n  } catch (err) {\r\n    res.status(500).json({ message: 'Error al contar cotizaciones', error: err });\r\n  }\r\n});\r\n\r\n\r\n\r\n\r\n// =================== HISTORIAL DE COTIZACIONES ===================\r\n// =================== HISTORIAL DE COTIZACIONES ===================\r\n\r\n/**\r\n * GET /cotizaciones\r\n * Obtiene todas las cotizaciones (para panel admin)\r\n */\r\napp.get('/cotizaciones', async (req, res) => {\r\n  try {\r\n    const historial = await Cotizacion.find()\r\n      .sort({ fecha: -1 })\r\n      .populate('userId', 'nombre email')\r\n      .lean();\r\n\r\n    // Normaliza nombres de productos\r\n    historial.forEach(cot => {\r\n      if (cot.productos && Array.isArray(cot.productos)) {\r\n        cot.productos = cot.productos.map(p => ({\r\n          nombre: p.nombre || p.name || 'Sin nombre',\r\n          cantidad: p.cantidad || 1,\r\n          precio: p.precio || 0\r\n        }));\r\n      }\r\n    });\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      count: historial.length,\r\n      data: historial,\r\n    });\r\n  } catch (err) {\r\n    console.error('Error al obtener todas las cotizaciones:', err);\r\n    res.status(500).json({\r\n      success: false,\r\n      message: 'Error al obtener cotizaciones',\r\n      error: err.message,\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * GET /cotizaciones/usuario/:userId\r\n * Obtiene las cotizaciones de un usuario espec√≠fico\r\n */\r\napp.get('/cotizaciones/usuario/:userId', async (req, res) => {\r\n  try {\r\n    const { userId } = req.params;\r\n\r\n    if (!userId || userId === 'undefined' || userId === 'null') {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'ID de usuario no v√°lido',\r\n      });\r\n    }\r\n\r\n    console.log(`üîé Buscando historial de cotizaciones del usuario: ${userId}`);\r\n\r\n    // Buscar cotizaciones del usuario con populate\r\n    const cotizaciones = await Cotizacion.find({ userId })\r\n      .sort({ fecha: -1 })\r\n      .populate({\r\n        path: 'productos.productoId',\r\n        model: 'Product', // Aseg√∫rate de que coincida con el nombre de tu modelo\r\n        select: 'name nombre image category description precio',\r\n        strictPopulate: false\r\n      })\r\n      .select('fecha productos estado createdAt updatedAt')\r\n      .lean();\r\n\r\n    // Ajustamos el formato de los productos\r\n    cotizaciones.forEach(cot => {\r\n      if (cot.productos && Array.isArray(cot.productos)) {\r\n        cot.productos = cot.productos.map(p => {\r\n          const producto = p.productoId || {};\r\n          return {\r\n          nombre: p.equipo || p.nombre || p.name || 'Sin nombre',\r\n            cantidad: p.cantidad || 1,\r\n            precio: producto.precio || 0,\r\n            imagen: producto.image || '',\r\n            categoria: producto.category || '',\r\n          };\r\n        });\r\n      }\r\n    });\r\n\r\n    return res.status(200).json({\r\n      success: true,\r\n      count: cotizaciones.length,\r\n      data: cotizaciones,\r\n    });\r\n  } catch (err) {\r\n    console.error('Error al obtener historial del usuario:', err);\r\n    res.status(500).json({\r\n      success: false,\r\n      message: 'Error al obtener historial del usuario',\r\n      error: err.message,\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * GET /cotizaciones/:cotizacionId\r\n * Obtiene los detalles de una cotizaci√≥n espec√≠fica\r\n */\r\napp.get('/cotizaciones/:cotizacionId', async (req, res) => {\r\n  try {\r\n    const { cotizacionId } = req.params;\r\n\r\n    if (!cotizacionId || cotizacionId === 'undefined') {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'ID de cotizaci√≥n no v√°lido',\r\n      });\r\n    }\r\n\r\n    const cotizacion = await Cotizacion.findById(cotizacionId)\r\n      .populate({\r\n        path: 'productos.productoId',\r\n        model: 'Product',\r\n        select: 'name nombre image category description precio',\r\n        strictPopulate: false\r\n      })\r\n      .lean();\r\n\r\n    if (!cotizacion) {\r\n      return res.status(404).json({\r\n        success: false,\r\n        message: 'Cotizaci√≥n no encontrada',\r\n      });\r\n    }\r\n\r\n    // Normaliza productos\r\n    if (cotizacion.productos && Array.isArray(cotizacion.productos)) {\r\n      cotizacion.productos = cotizacion.productos.map(p => {\r\n        const producto = p.productoId || {};\r\n        return {\r\n        nombre: p.equipo || p.nombre || p.name || 'Sin nombre',\r\n          cantidad: p.cantidad || 1,\r\n          precio: producto.precio || 0,\r\n          imagen: producto.image || '',\r\n          categoria: producto.category || '',\r\n        };\r\n      });\r\n    }\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      data: cotizacion,\r\n    });\r\n  } catch (err) {\r\n    console.error('Error al obtener cotizaci√≥n:', err);\r\n    res.status(500).json({\r\n      success: false,\r\n      message: 'Error al obtener la cotizaci√≥n',\r\n      error: err.message,\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * PATCH /cotizaciones/:cotizacionId/estado\r\n * Actualiza el estado de una cotizaci√≥n\r\n */\r\napp.patch('/cotizaciones/:cotizacionId/estado', async (req, res) => {\r\n  try {\r\n    const { cotizacionId } = req.params;\r\n    const { estado } = req.body;\r\n\r\n    const estadosPermitidos = [\r\n      'pendiente',\r\n      'en proceso',\r\n      'atendida',\r\n      'completada',\r\n      'cancelada',\r\n    ];\r\n\r\n    if (!estado || !estadosPermitidos.includes(estado.toLowerCase())) {\r\n      return res.status(400).json({\r\n        success: false,\r\n        message: 'Estado no v√°lido',\r\n        estadosPermitidos,\r\n      });\r\n    }\r\n\r\n    const cotizacion = await Cotizacion.findByIdAndUpdate(\r\n      cotizacionId,\r\n      { estado: estado.toLowerCase(), updatedAt: new Date() },\r\n      { new: true, runValidators: true }\r\n    );\r\n\r\n    if (!cotizacion) {\r\n      return res.status(404).json({\r\n        success: false,\r\n        message: 'Cotizaci√≥n no encontrada',\r\n      });\r\n    }\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'Estado actualizado correctamente',\r\n      data: cotizacion,\r\n    });\r\n  } catch (err) {\r\n    console.error('Error al actualizar estado:', err);\r\n    res.status(500).json({\r\n      success: false,\r\n      message: 'Error al actualizar el estado',\r\n      error: err.message,\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * DELETE /cotizaciones/:cotizacionId\r\n * Elimina una cotizaci√≥n\r\n */\r\napp.delete('/cotizaciones/:cotizacionId', async (req, res) => {\r\n  try {\r\n    const { cotizacionId } = req.params;\r\n\r\n    const cotizacion = await Cotizacion.findByIdAndDelete(cotizacionId);\r\n\r\n    if (!cotizacion) {\r\n      return res.status(404).json({\r\n        success: false,\r\n        message: 'Cotizaci√≥n no encontrada',\r\n      });\r\n    }\r\n\r\n    res.status(200).json({\r\n      success: true,\r\n      message: 'Cotizaci√≥n eliminada correctamente',\r\n    });\r\n  } catch (err) {\r\n    console.error('Error al eliminar cotizaci√≥n:', err);\r\n    res.status(500).json({\r\n      success: false,\r\n      message: 'Error al eliminar la cotizaci√≥n',\r\n      error: err.message,\r\n    });\r\n  }\r\n});\r\n\r\napp.put('/cotizaciones/:id', async (req, res) => {\r\n  try {\r\n    const { id } = req.params;\r\n    const { estado } = req.body;\r\n\r\n    const cotizacion = await Cotizacion.findByIdAndUpdate(\r\n      id,\r\n      { estado },\r\n      { new: true }\r\n    );\r\n\r\n    if (!cotizacion) {\r\n      return res.status(404).json({ success: false, message: 'Cotizaci√≥n no encontrada' });\r\n    }\r\n\r\n    res.json({ success: true, data: cotizacion });\r\n  } catch (error) {\r\n    console.error(error);\r\n    res.status(500).json({ success: false, message: 'Error al actualizar el estado' });\r\n  }\r\n});\r\n\r\n\r\n\r\n\r\n// =================== FIN PRODUCTOS ===================\r\n\r\n// Iniciar servidor\r\napp.listen(PORT, () => {\r\n    console.log(`Server running on http://localhost:${PORT}`);\r\n});\r\n\r\n\r\n\r\n\r\n\r\n"],"file":"server.dev.js"}